<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Практика: расчёт налоговой нагрузки (3 задания)</title>
<style>
  :root{
    --bg:#ffffff; --text:#0f172a; --muted:#475569; --card:#f8fafc; --border:#e2e8f0;
    --ok:#10b981; --warn:#f59e0b; --bad:#ef4444; --primary:#3b82f6;
  }
  html,body{margin:0;padding:0;background:var(--bg);color:var(--text);font:16px/1.55 system-ui,-apple-system,Segoe UI,Roboto,Arial;}
  .wrap{max-width:1000px;margin:0 auto;padding:22px 14px 60px;}
  h1{margin:0 0 6px;font-size:28px;font-weight:800}
  p.small{color:var(--muted);margin:4px 0 18px}
  .tabs{display:flex;gap:6px;flex-wrap:wrap;margin:14px 0}
  .tab-btn{border:1px solid var(--border);background:#fff;padding:8px 12px;border-radius:10px;cursor:pointer}
  .tab-btn.active{background:var(--primary);color:#fff;border-color:var(--primary)}
  .card{border:1px solid var(--border);background:var(--card);border-radius:14px;padding:14px 14px 18px;margin:12px 0}
  .grid{display:grid;gap:10px}
  @media(min-width:780px){.grid{grid-template-columns:1fr 1fr}}
  label{display:block;font-weight:600;margin:10px 0 4px}
  input,select,textarea{width:100%;padding:10px;border:1px solid var(--border);border-radius:10px;background:#fff;font:inherit}
  .row{display:flex;gap:10px;flex-wrap:wrap}
  .row>div{flex:1 1 240px}
  .btn{display:inline-block;background:var(--primary);color:#fff;border:1px solid var(--primary);padding:10px 14px;border-radius:10px;cursor:pointer}
  .btn.ghost{background:#fff;color:var(--primary)}
  .res{border:1px dashed var(--border);border-radius:12px;padding:12px;background:#fff;margin-top:10px}
  .bar{height:10px;background:#e5e7eb;border-radius:999px;overflow:hidden;margin-top:8px}
  .bar>span{display:block;height:100%;background:linear-gradient(90deg,#34d399,#22c55e);width:0%}
  .pill{display:inline-block;padding:2px 8px;border-radius:999px;border:1px solid var(--border);color:var(--muted);font-size:12px;margin-left:6px}
  .hint{font-size:14px;color:var(--muted);margin-top:6px}
  .ok{color:var(--ok)} .warn{color:var(--warn)} .bad{color:var(--bad)}
  .foot{font-size:13px;color:var(--muted);margin-top:20px}
  .hide{display:none}
  code{background:#fff;border:1px solid var(--border);padding:2px 6px;border-radius:8px}
</style>
</head>
<body>
<div class="wrap">
  <h1>Практика: расчёт налоговой нагрузки</h1>
  <p class="small">Три задания: рассчитайте показатели, сравните с бенчмарками и сформируйте пояснения. Сохраните результаты в заметках Степика.</p>

  <!-- Навигация -->
  <div class="tabs" role="tablist" aria-label="Практические задания">
    <button class="tab-btn active" data-tab="t1" role="tab" aria-selected="true">1) Нагрузка по счёту (≥ 0,9%)</button>
    <button class="tab-btn" data-tab="t2" role="tab" aria-selected="false">2) Общая нагрузка бизнеса</button>
    <button class="tab-btn" data-tab="t3" role="tab" aria-selected="false">3) Сравнение с отраслью</button>
  </div>

  <!-- Задание 1 -->
  <section id="t1" class="tab card">
    <h2>Задание 1. Минимальная налоговая нагрузка по счёту</h2>
    <p>Рассчитайте долю налогов, НДФЛ и страховых взносов в дебетовом обороте счёта за выбранный период.</p>

    <div class="grid">
      <div>
        <label for="t1_turnover">Дебетовый оборот счёта за период, ₽</label>
        <input id="t1_turnover" type="number" min="0" step="0.01" placeholder="например, 18 000 000">
      </div>
      <div>
        <label for="t1_taxes">Уплачено налогов с р/с за период, ₽ <span class="pill">НДС/прибыль/УСН и др.</span></label>
        <input id="t1_taxes" type="number" min="0" step="0.01" placeholder="например, 150 000">
      </div>
      <div>
        <label for="t1_ndfl">Уплачено НДФЛ, ₽</label>
        <input id="t1_ndfl" type="number" min="0" step="0.01" placeholder="например, 50 000">
      </div>
      <div>
        <label for="t1_siv">Страховые взносы, ₽</label>
        <input id="t1_siv" type="number" min="0" step="0.01" placeholder="например, 20 000">
      </div>
    </div>

    <div class="row" style="margin-top:8px">
      <button class="btn" id="t1_calc">Рассчитать</button>
      <button class="btn ghost" id="t1_reset" type="button">Сбросить</button>
    </div>

    <div class="res" id="t1_res" aria-live="polite">
      <div><strong>Формула:</strong> (Налоги + НДФЛ + взносы) ÷ Дебетовый оборот × 100%</div>
      <div class="bar"><span id="t1_bar"></span></div>
      <div class="hint" id="t1_hint"></div>
    </div>
  </section>

  <!-- Задание 2 -->
  <section id="t2" class="tab card hide">
    <h2>Задание 2. Общая налоговая нагрузка бизнеса</h2>
    <p>Рассчитайте отношение всех уплаченных налогов и сборов к выручке за год (Форма №2, строка 2110). Учтите систему налогообложения.</p>

    <div class="grid">
      <div>
        <label for="t2_revenue">Выручка за год (стр. 2110), ₽</label>
        <input id="t2_revenue" type="number" min="0" step="0.01" placeholder="например, 60 000 000">
      </div>
      <div>
        <label for="t2_alltax">Все налоги и сборы за год, ₽</label>
        <input id="t2_alltax" type="number" min="0" step="0.01" placeholder="например, 9 000 000">
      </div>
      <div>
        <label for="t2_sys">Система налогообложения</label>
        <select id="t2_sys">
          <option value="OSNO">ОСНО</option>
          <option value="USN6">УСН 6% (доходы)</option>
          <option value="USN15">УСН 15% (доходы-расходы)</option>
          <option value="PATENT">Патент</option>
          <option value="NPD">Самозанятый (НПД)</option>
        </select>
      </div>
      <div>
        <label for="t2_include">Что включать в «все налоги»?</label>
        <textarea id="t2_include" rows="4" placeholder="НДС/прибыль или УСН, НДФЛ, страховые взносы, прочие..."></textarea>
      </div>
    </div>

    <div class="row" style="margin-top:8px">
      <button class="btn" id="t2_calc">Рассчитать</button>
      <button class="btn ghost" id="t2_reset" type="button">Сбросить</button>
    </div>

    <div class="res" id="t2_res" aria-live="polite">
      <div><strong>Формула:</strong> Все налоги и сборы ÷ Выручка × 100%</div>
      <div class="bar"><span id="t2_bar"></span></div>
      <div class="hint" id="t2_hint"></div>
      <div class="foot" id="t2_range_note"></div>
    </div>
  </section>

  <!-- Задание 3 -->
  <section id="t3" class="tab card hide">
    <h2>Задание 3. Сравнение с отраслевыми нормами</h2>
    <p>Выберите отрасль, укажите свой показатель общей налоговой нагрузки и получите оценку + шаблон пояснения.</p>

    <div class="grid">
      <div>
        <label for="t3_ind">Отрасль (бенчмарк, %)</label>
        <select id="t3_ind">
          <!-- Значения — ориентиры для учебных задач (можно менять под ваши материалы) -->
          <option value="14">Оптовая торговля — 14%</option>
          <option value="12">Розничная торговля — 12%</option>
          <option value="16">Производство — 16%</option>
          <option value="10">ИТ-услуги — 10%</option>
          <option value="18">Строительство — 18%</option>
          <option value="9">Услуги (прочие) — 9%</option>
        </select>
      </div>
      <div>
        <label for="t3_your">Ваш показатель (общая нагрузка), %</label>
        <input id="t3_your" type="number" min="0" step="0.01" placeholder="например, 4.5">
      </div>
    </div>

    <div class="row" style="margin-top:8px">
      <button class="btn" id="t3_calc">Сравнить</button>
      <button class="btn ghost" id="t3_reset" type="button">Сбросить</button>
    </div>

    <div class="res" id="t3_res" aria-live="polite">
      <div id="t3_msg"></div>
      <div class="bar"><span id="t3_bar"></span></div>
      <div class="hint" id="t3_hint"></div>
      <label for="t3_text" style="margin-top:8px;display:block;font-weight:700">Готовый шаблон пояснения:</label>
      <textarea id="t3_text" rows="6" spellcheck="false"></textarea>
    </div>
  </section>

  <p class="foot">Совет: после расчётов скопируйте результаты в ответ на задание Степика. Диапазоны — учебные, ориентированы на практику (0,9% по счёту; 10–20% по бизнесу зависит от отрасли/режима).</p>
</div>

<script>
/* ---------- табы ---------- */
document.querySelectorAll('.tab-btn').forEach(btn=>{
  btn.addEventListener('click', ()=>{
    document.querySelectorAll('.tab-btn').forEach(b=>b.classList.remove('active'));
    document.querySelectorAll('.tab').forEach(s=>s.classList.add('hide'));
    btn.classList.add('active');
    document.getElementById(btn.dataset.tab).classList.remove('hide');
  });
});

/* ---------- Задание 1: Нагрузка по счёту ---------- */
const t1 = {
  turnover: document.getElementById('t1_turnover'),
  taxes: document.getElementById('t1_taxes'),
  ndfl: document.getElementById('t1_ndfl'),
  siv: document.getElementById('t1_siv'),
  bar: document.getElementById('t1_bar'),
  hint: document.getElementById('t1_hint')
};
document.getElementById('t1_calc').addEventListener('click', ()=>{
  const turn = +t1.turnover.value || 0;
  const sum = (+t1.taxes.value||0) + (+t1.ndfl.value||0) + (+t1.siv.value||0);
  if(turn<=0){ t1.hint.innerHTML = '<span class="bad">Введите дебетовый оборот &gt; 0.</span>'; t1.bar.style.width='0%'; return; }
  const pct = sum/turn*100;
  const width = Math.min(100, pct*2); // визуально
  t1.bar.style.width = width + '%';
  let cls='bad', msg='Ниже ориентира 0,9% — высокий риск.';
  if(pct>=0.9 && pct<1.5){ cls='ok'; msg='Соответствует минимуму 0,9%.'; }
  if(pct>=1.5){ cls='ok'; msg='Выше минимума, выглядит убедительно.'; }
  t1.hint.innerHTML = `Итого: <strong>${pct.toFixed(2)}%</strong> — <span class="${cls}">${msg}</span>`;
});
document.getElementById('t1_reset').addEventListener('click', ()=>{
  ['t1_turnover','t1_taxes','t1_ndfl','t1_siv'].forEach(id=>document.getElementById(id).value='');
  t1.bar.style.width='0%'; t1.hint.textContent='';
});

/* ---------- Задание 2: Общая нагрузка ---------- */
const ranges = {
  OSNO: {min:10, max:25, note:'ОСНО: обычно 15–25% (НДС, прибыль, НДФЛ, взносы).'},
  USN6: {min:5,  max:10, note:'УСН 6%: обычно 5–10% (УСН, НДФЛ, взносы).'},
  USN15:{min:7,  max:12, note:'УСН 15%: обычно 7–12% (зависит от доли расходов).'},
  PATENT:{min:2, max:5,  note:'Патент: 2–5% — фиксированный налог, нужна аргументация при больших оборотах.'},
  NPD:  {min:4,  max:6,  note:'Самозанятые: 4–6% — налог на профдоход, важна регулярность.'}
};
const t2 = {
  revenue: document.getElementById('t2_revenue'),
  alltax: document.getElementById('t2_alltax'),
  sys: document.getElementById('t2_sys'),
  bar: document.getElementById('t2_bar'),
  hint: document.getElementById('t2_hint'),
  note: document.getElementById('t2_range_note')
};
function t2updateNote(){ t2.note.textContent = ranges[t2.sys.value].note; }
t2updateNote();
t2.sys.addEventListener('change', t2updateNote);

document.getElementById('t2_calc').addEventListener('click', ()=>{
  const rev = +t2.revenue.value || 0;
  const tax = +t2.alltax.value || 0;
  if(rev<=0){ t2.hint.innerHTML = '<span class="bad">Введите выручку &gt; 0.</span>'; t2.bar.style.width='0%'; return; }
  const pct = tax/rev*100;
  t2.bar.style.width = Math.min(100, pct*2) + '%';
  const {min,max} = ranges[t2.sys.value];
  let cls='warn', msg=`Вне ориентиров ${min}–${max}%. Подготовьте пояснения.`;
  if(pct<min) { cls='warn'; msg=`Ниже типичного диапазона ${min}–${max}%. Объясните режим, сезонность или субсидии.`; }
  if(pct>=min && pct<=max){ cls='ok'; msg=`В пределах ориентиров для ${t2.sys.value}.`; }
  if(pct>max){ cls='warn'; msg=`Выше типичного диапазона ${min}–${max}%. Проверьте корректность/оптимизацию.`; }
  t2.hint.innerHTML = `Итого: <strong>${pct.toFixed(2)}%</strong> — <span class="${cls}">${msg}</span>`;
});
document.getElementById('t2_reset').addEventListener('click', ()=>{
  ['t2_revenue','t2_alltax','t2_include'].forEach(id=>{ const el=document.getElementById(id); if(el) el.value=''; });
  t2.bar.style.width='0%'; t2.hint.textContent='';
  t2.sys.value='OSNO'; t2updateNote();
});

/* ---------- Задание 3: Сравнение с отраслью ---------- */
const t3 = {
  ind: document.getElementById('t3_ind'),
  your: document.getElementById('t3_your'),
  msg: document.getElementById('t3_msg'),
  bar: document.getElementById('t3_bar'),
  hint: document.getElementById('t3_hint'),
  text: document.getElementById('t3_text')
};
document.getElementById('t3_calc').addEventListener('click', ()=>{
  const bench = +t3.ind.value;
  const val = +t3.your.value || 0;
  if(val<=0){ t3.msg.innerHTML='<span class="bad">Укажите ваш показатель &gt; 0.</span>'; t3.bar.style.width='0%'; t3.hint.textContent=''; t3.text.value=''; return; }
  t3.bar.style.width = Math.min(100, val*2) + '%';
  let cls='ok', msg='Соответствует отраслевому уровню.';
  if(val < bench*0.7){ cls='warn'; msg='Существенно ниже отрасли — готовьте детальное пояснение.'; }
  else if(val < bench){ cls='warn'; msg='Ниже среднего — краткое пояснение желательно.'; }
  else if(val > bench*1.5){ cls='warn'; msg='Существенно выше — проверьте корректность и экономику.'; }

  t3.msg.innerHTML = `Ваш показатель: <strong>${val.toFixed(2)}%</strong> (бенчмарк отрасли: ${bench}%)
  — <span class="${cls}">${msg}</span>`;
  t3.hint.textContent = 'Подсказка: используйте режим налогообложения, сезонность, структуру расходов/льгот как аргументы.';

  // Авто-шаблон пояснения
  const template = `
Компания применяет систему налогообложения: [указать: ОСНО/УСН/Патент/НПД]. 
Показатель общей налоговой нагрузки за отчётный период составил ${val.toFixed(2)}% при отраслевом уровне ${bench}%. 
Отклонение объясняется: [режим налогообложения и ставка], [сезонность продаж], [структура расходов/льготы/субсидии], [предоплаты/отставание налогов во времени]. 
Платежи НДФЛ и страховых взносов осуществляются регулярно, подтверждающие документы и расчёты приложены.`;
  t3.text.value = template.trim();
});
document.getElementById('t3_reset').addEventListener('click', ()=>{
  t3.ind.value='14'; t3.your.value=''; t3.msg.textContent=''; t3.hint.textContent=''; t3.bar.style.width='0%'; t3.text.value='';
});
</script>
</body>
</html>
