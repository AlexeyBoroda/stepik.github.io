<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>–ß–µ–∫-–ª–∏—Å—Ç: –∫–∞–∫ –∏–∑–±–µ–∂–∞—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ —Å—á—ë—Ç–∞</title>
<style>
  :root{
    --bg:#ffffff; --fg:#0f172a; --muted:#475569; --line:#e5e7eb;
    --primary:#0b3b7e; --accent:#16a34a; --accent-200:#bbf7d0; --accent-50:#ecfdf5;
    --card:#f8fafc; --note:#f1f5f9; --warn:#fb923c1a; --warn-line:#fed7aa;
  }
  html,body{height:100%}
  body{margin:0; font:16px/1.55 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; background:#ffffff; color:var(--fg);}
  .container{max-width:980px;margin:auto;padding:22px 16px;}
  h1{margin:0 0 6px; font-size:28px; color:var(--primary);}
  .sub{margin:0 0 18px; color:var(--muted); font-size:14px}
  .topbar{display:flex; flex-wrap:wrap; gap:8px; align-items:center; justify-content:space-between; margin:8px 0 18px}
  .progress{position:relative; width:100%; height:12px; background:var(--note); border:1px solid var(--line); border-radius:999px; overflow:hidden;}
  .progress>span{display:block; height:100%; width:0%; background:linear-gradient(90deg,var(--accent),#22c55e); transition:width .2s;}
  .hint{color:var(--muted); font-size:13px}
  .toolbar{display:flex; gap:8px; flex-wrap:wrap}
  button, .btn {appearance:none; border:1px solid var(--line); background:var(--card); color:var(--fg);
    border-radius:10px; padding:8px 12px; font-weight:600; cursor:pointer;}
  button:hover{filter:brightness(1.05)}
  .sections{display:grid; gap:14px}
  details.card{border:1px solid var(--line); border-radius:14px; background:var(--card); padding:10px 12px;}
  summary{list-style:none; cursor:pointer; display:flex; align-items:center; gap:10px; padding:4px 4px;}
  summary::-webkit-details-marker{display:none}
  .sumttl{font-weight:700; color:var(--primary)}
  .badge{margin-left:auto; font-size:12px; color:var(--muted)}
  .tasks{display:grid; gap:10px; margin:8px 0 4px}
  .task{display:grid; grid-template-columns:auto 1fr; gap:12px; align-items:start;
    border:1px dashed var(--line); background:var(--bg); border-radius:12px; padding:12px;}
  .box{display:inline-grid; place-items:center; width:24px; height:24px; border-radius:8px; border:2px solid var(--line); background:#fff0; cursor:pointer}
  input[type="checkbox"]{appearance:none; width:18px; height:18px;}
  input[type="checkbox"]:checked + .box{background:var(--accent); border-color:var(--accent)}
  input[type="checkbox"]:checked + .box::after{content:"‚úì"; color:#fff; font-weight:800; font-size:14px}
  .label{font-weight:600}
  .note{grid-column:1/-1; margin:6px 0 0}
  .note textarea{width:100%; min-height:70px; padding:8px 10px; border:1px solid var(--line); border-radius:10px; background:#ffffff; color:var(--fg);}
  .section-progress{display:flex; align-items:center; gap:8px; margin:6px 2px 2px}
  .mini{flex:1; height:8px; background:var(--note); border:1px solid var(--line); border-radius:999px; overflow:hidden}
  .mini>span{display:block; height:100%; width:0%; background:linear-gradient(90deg,var(--accent),#22c55e)}
  .warn{background:var(--warn); border:1px solid var(--warn-line); padding:10px 12px; border-radius:12px; color:var(--muted); font-size:14px}
  footer{margin-top:16px; display:flex; gap:10px; align-items:center; justify-content:space-between; flex-wrap:wrap}
  .small{font-size:12px; color:var(--muted)}
  @media print{ .toolbar, footer{display:none} body{background:#fff} .card{break-inside:avoid} }
</style>
</head>
<body>
  <div class="container">
    <h1>–ß–µ–∫-–ª–∏—Å—Ç: –∫–∞–∫ –∏–∑–±–µ–∂–∞—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ —Å—á—ë—Ç–∞</h1>
    <p class="sub">–û—Ç–º–µ—á–∞–π—Ç–µ –ø—É–Ω–∫—Ç—ã, —Ñ–∏–∫—Å–∏—Ä—É–π—Ç–µ –∑–∞–º–µ—Ç–∫–∏ –∏ —Å–æ—Ö—Ä–∞–Ω—è–π—Ç–µ –ø—Ä–æ–≥—Ä–µ—Å—Å –ª–æ–∫–∞–ª—å–Ω–æ. –ú–æ–∂–Ω–æ —Ä–∞—Å–ø–µ—á–∞—Ç–∞—Ç—å –≤ PDF.</p>

    <div class="topbar">
      <div style="flex:1; min-width:220px">
        <div class="progress" aria-label="–û–±—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å"><span id="totalBar"></span></div>
        <div class="hint"><span id="totalCount">0</span> –∏–∑ <span id="totalAll">0</span> –≤—ã–ø–æ–ª–Ω–µ–Ω–æ</div>
      </div>
      <div class="toolbar">
        <button id="btnPrint">–ü–µ—á–∞—Ç—å / PDF</button>
        <button id="btnExport">–≠–∫—Å–ø–æ—Ä—Ç</button>
        <label class="btn" for="fileImport">–ò–º–ø–æ—Ä—Ç
          <input id="fileImport" type="file" accept="application/json" style="display:none">
        </label>
        <button id="btnReset">–°–±—Ä–æ—Å</button>
      </div>
    </div>

    <div id="sections" class="sections"></div>

    <footer>
      <div class="warn">–°–æ–≤–µ—Ç: –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ –Ω–∞–ª–æ–≥–æ–≤—É—é –Ω–∞–≥—Ä—É–∑–∫—É –ø–æ —Å—á—ë—Ç—É ‚â• 0,9% –æ—Ç –¥–µ–±–µ—Ç–æ–≤–æ–≥–æ –æ–±–æ—Ä–æ—Ç–∞ –∏ —Ö—Ä–∞–Ω–∏—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –ø–æ –∫–∞–∂–¥–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏.</div>
      <div class="small">–ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ: <strong>–≤–∫–ª—é—á–µ–Ω–æ</strong> ¬∑ –î–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –≤–∞—à–µ–º –±—Ä–∞—É–∑–µ—Ä–µ</div>
    </footer>
  </div>

<script>
const DATA = [
  { id:"ops",  title:"–ë—ã—Å—Ç—Ä–∞—è —Å–∞–º–æ–ø—Ä–æ–≤–µ—Ä–∫–∞ –æ–ø–µ—Ä–∞—Ü–∏–π", items:[
    {id:"ops1", text:"–ù–µ—Ç —Ç—Ä–∞–Ω–∑–∏—Ç–æ–≤ –±–µ–∑ —Å–º—ã—Å–ª–∞ ‚Äî –¥–µ–Ω—å–≥–∏ –Ω–µ —É—Ö–æ–¥—è—Ç —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –∑–∞—á–∏—Å–ª–µ–Ω–∏—è; –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞ –ø–æ–Ω—è—Ç–Ω–æ–µ."},
    {id:"ops2", text:"–ù–∞–ª–∏—á–Ω—ã–µ —Å–Ω–∏–º–∞—é—Ç—Å—è —Ä–µ–¥–∫–æ –∏ –ø–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º ‚Äî –ø–æ –∫—Ä—É–ø–Ω—ã–º —Å–Ω—è—Ç–∏—è–º –µ—Å—Ç—å –∞–≤–∞–Ω—Å–æ–≤—ã–µ –æ—Ç—á—ë—Ç—ã –∏ —á–µ–∫–∏."},
    {id:"ops3", text:"–ù–∞–ª–æ–≥–æ–≤–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –ø–æ —Å—á—ë—Ç—É –∑–∞ –º–µ—Å—è—Ü ‚â• 0,9% –æ—Ç –¥–µ–±–µ—Ç–æ–≤–æ–≥–æ –æ–±–æ—Ä–æ—Ç–∞."},
    {id:"ops4", text:"–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–µ–π —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –≤–∏–¥–∞–º –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (–û–ö–í–≠–î) –∏ –¥–æ–≥–æ–≤–æ—Ä–∞–º."},
    {id:"ops5", text:"–ù–µ—Ç –∞–Ω–æ–º–∞–ª–∏–π ‚Äî —Ä–µ–∑–∫–∏—Ö —Å–∫–∞—á–∫–æ–≤ –æ–±–æ—Ä–æ—Ç–∞ –∏ –¥–µ—Å—è—Ç–∫–æ–≤ –æ–¥–Ω–æ—Ç–∏–ø–Ω—ã—Ö –ø–µ—Ä–µ–≤–æ–¥–æ–≤ –±–µ–∑ –æ–±—ä—è—Å–Ω–µ–Ω–∏–π."}
  ]},
  { id:"docs", title:"–î–æ–∫—É–º–µ–Ω—Ç—ã –ø–æ —Å–¥–µ–ª–∫–∞–º", items:[
    {id:"docs1", text:"–ü–æ –∫–∞–∂–¥–æ–π –æ–ø–ª–∞—Ç–µ –≥–æ—Ç–æ–≤ –∫–æ–º–ø–ª–µ–∫—Ç: –¥–æ–≥–æ–≤–æ—Ä, —Å—á—ë—Ç/—Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è, –∞–∫—Ç/–Ω–∞–∫–ª–∞–¥–Ω–∞—è, –ø–µ—Ä–µ–ø–∏—Å–∫–∞ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏."},
    {id:"docs2", text:"–ü–æ –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º –ø–ª–∞—Ç–µ–∂–∞–º –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–∞ –∫—Ä–∞—Ç–∫–∞—è –ø–æ—è—Å–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–ø–∏—Å–∫–∞ (1‚Äì3 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è)."},
    {id:"docs3", text:"–†–µ–∫–≤–∏–∑–∏—Ç—ã –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞ –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã: –ò–ù–ù/–û–ì–†–ù –∏ –∞–¥—Ä–µ—Å —Å–æ–≤–ø–∞–¥–∞—é—Ç —Å –≤—ã–ø–∏—Å–∫–æ–π –ï–ì–†–Æ–õ/–ï–ì–†–ò–ü."}
  ]},
  { id:"ctr",  title:"–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–æ–≤", items:[
    {id:"ctr1", text:"–ü—Ä–æ–≤–µ—Ä–µ–Ω –≤ –§–ù–° ¬´–ü—Ä–æ–∑—Ä–∞—á–Ω—ã–π –±–∏–∑–Ω–µ—Å¬ª –∏ –ï–ì–†–Æ–õ/–ï–ì–†–ò–ü: —Å—Ç–∞—Ç—É—Å –¥–µ–π—Å—Ç–≤—É—é—â–∏–π, –∞–¥—Ä–µ—Å –Ω–µ –º–∞—Å—Å–æ–≤—ã–π."},
    {id:"ctr2", text:"–ù–µ—Ç –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ ¬´–æ–¥–Ω–æ–¥–Ω–µ–≤–∫–∏¬ª: —Å–≤–µ–∂–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –±–µ–∑ —à—Ç–∞—Ç–∞, –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–≤—è–∑–∏ —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—è, –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤."},
    {id:"ctr3", text:"–ï—Å—Ç—å –¥–µ–ª–æ–≤–∞—è —Ü–µ–ª—å —Å–¥–µ–ª–∫–∏ –∏ –∞–¥–µ–∫–≤–∞—Ç–Ω–∞—è —Ä—ã–Ω–æ—á–Ω–∞—è —Ü–µ–Ω–∞."}
  ]},
  { id:"fin",  title:"–§–∏–Ω–∞–Ω—Å–æ–≤–∞—è –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞", items:[
    {id:"fin1", text:"–ù–∞–ª–æ–≥–∏, –ù–î–§–õ –∏ —Å—Ç—Ä–∞—Ö–æ–≤—ã–µ –≤–∑–Ω–æ—Å—ã —É–ø–ª–∞—á–∏–≤–∞—é—Ç—Å—è –≤–æ–≤—Ä–µ–º—è; –∑–∞—Ä–ø–ª–∞—Ç—ã –≤—ã–ø–ª–∞—á–∏–≤–∞—é—Ç—Å—è —Ä–µ–≥—É–ª—è—Ä–Ω–æ."},
    {id:"fin2", text:"–§–û–¢ —Å–æ—Ä–∞–∑–º–µ—Ä–µ–Ω –æ–±–æ—Ä–æ—Ç—É ‚Äî –Ω–µ—Ç ¬´–Ω—É–ª–µ–≤—ã—Ö¬ª –Ω–∞–ª–æ–≥–æ–≤ –ø—Ä–∏ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è—Ö."},
    {id:"fin3", text:"–ú–∏–Ω–∏–º—É–º –Ω–∞–ª–∏—á–Ω—ã—Ö —Ä–∞—Å—á—ë—Ç–æ–≤; –ø–æ –≤—ã–ø–ª–∞—Ç–∞–º —Ñ–∏–∑–ª–∏—Ü–∞–º –µ—Å—Ç—å –¥–æ–≥–æ–≤–æ—Ä—ã –∏ –∞–∫—Ç—ã."}
  ]},
  { id:"risk", title:"–ó–æ–Ω—ã –ø–æ–≤—ã—à–µ–Ω–Ω–æ–≥–æ —Ä–∏—Å–∫–∞", items:[
    {id:"risk1", text:"–ù–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏–π —Å –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–æ–π –∏ –∑–∞—Ä—É–±–µ–∂–Ω—ã—Ö –ø–µ—Ä–µ–≤–æ–¥–æ–≤ –±–µ–∑ –ø–æ–ª–Ω–æ–≥–æ –ø–∞–∫–µ—Ç–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–π."},
    {id:"risk2", text:"–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–µ ¬´–¥—Ä–æ–±–ª–µ–Ω–∏–µ¬ª –±–∏–∑–Ω–µ—Å–∞ —Ä–∞–¥–∏ –Ω–∞–ª–æ–≥–æ–≤–æ–π —ç–∫–æ–Ω–æ–º–∏–∏."},
    {id:"risk3", text:"–î–∞–Ω–Ω—ã–µ –≤ –ï–ì–†–Æ–õ –∞–∫—Ç—É–∞–ª—å–Ω—ã: –∞–¥—Ä–µ—Å, –û–ö–í–≠–î, —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –∏ –±–µ–Ω–µ—Ñ–∏—Ü–∏–∞—Ä—ã."}
  ]},
  { id:"comm", title:"–ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è —Å –±–∞–Ω–∫–æ–º", items:[
    {id:"comm1", text:"–ù–∞–∑–Ω–∞—á–µ–Ω –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π –∑–∞ –æ—Ç–≤–µ—Ç—ã –±–∞–Ω–∫—É –∏ –∫–æ–º–ø–ª–∞–µ–Ω—Å."},
    {id:"comm2", text:"–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –∑–∞–ø—Ä–æ—Å—ã –±–∞–Ω–∫–∞ –≤ —Ç–µ—á–µ–Ω–∏–µ 5‚Äì7 —Ä–∞–±–æ—á–∏—Ö –¥–Ω–µ–π —Å –ø–æ–ª–Ω—ã–º –ø–∞–∫–µ—Ç–æ–º –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤."},
    {id:"comm3", text:"–ï—Å—Ç—å —à–∞–±–ª–æ–Ω—ã –ø–∏—Å–µ–º –∏ –ø–æ—è—Å–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–ø–∏—Å–æ–∫ –ø–æ —Ç–∏–ø–æ–≤—ã–º –æ–ø–µ—Ä–∞—Ü–∏—è–º."}
  ]}
];

const STORAGE_KEY = "safe_checklist_v1";
const $ = (s,r=document)=>r.querySelector(s);
function loadState(){ try{ return JSON.parse(localStorage.getItem(STORAGE_KEY)) ?? {}; }catch(_){ return {}; } }
function saveState(x){ localStorage.setItem(STORAGE_KEY, JSON.stringify(x)); }
function pct(a,b){ return b ? Math.round(a/b*100) : 0; }

const state = loadState();

function render(){
  const wrap = $("#sections"); wrap.innerHTML = "";
  let totalAll = 0, totalDone = 0;

  for(const sec of DATA){
    const secState = state[sec.id] ?? {};
    const details = document.createElement("details");
    details.className = "card"; details.open = true;

    const summary = document.createElement("summary");
    summary.innerHTML = `<span>üìÇ</span><span class="sumttl">${sec.title}</span><span class="badge" id="${sec.id}-b"></span>`;
    details.appendChild(summary);

    const tasks = document.createElement("div"); tasks.className = "tasks";
    let done = 0;

    for(const it of sec.items){
      totalAll++;
      const s = (secState[it.id] ?? {checked:false, note:""});
      if(s.checked){ done++; totalDone++; }

      const label = document.createElement("label");
      label.className = "task";
      label.innerHTML = `
        <input type="checkbox" ${s.checked?"checked":""} data-sec="${sec.id}" data-id="${it.id}">
        <span class="box"></span>
        <div>
          <div class="label">${it.text}</div>
          <div class="note"><textarea placeholder="–ó–∞–º–µ—Ç–∫–∞..." data-note="${sec.id}:${it.id}">${s.note??""}</textarea></div>
        </div>`;
      tasks.appendChild(label);
    }

    details.appendChild(tasks);

    const secProg = document.createElement("div");
    secProg.className = "section-progress";
    secProg.innerHTML = `<div class="mini"><span style="width:${pct(done,sec.items.length)}%"></span></div><div class="hint">${done} –∏–∑ ${sec.items.length}</div>`;
    details.appendChild(secProg);

    wrap.appendChild(details);
    $(`#${sec.id}-b`).textContent = `${done}/${sec.items.length}`;
  }

  $("#totalAll").textContent = totalAll;
  $("#totalCount").textContent = totalDone;
  $("#totalBar").style.width = pct(totalDone,totalAll) + "%";
}
render();

document.addEventListener("change", e=>{
  if(e.target.matches('input[type="checkbox"][data-id]')){
    const sec = e.target.dataset.sec, id = e.target.dataset.id;
    state[sec] ??= {}; state[sec][id] ??= {};
    state[sec][id].checked = e.target.checked;
    saveState(state); render();
  }
  if(e.target.matches('textarea[data-note]')){
    const [sec,id] = e.target.dataset.note.split(":");
    state[sec] ??= {}; state[sec][id] ??= {};
    state[sec][id].note = e.target.value;
    saveState(state);
  }
});

$("#btnReset").addEventListener("click", ()=>{
  if(confirm("–°–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ –æ—Ç–º–µ—Ç–∫–∏ –∏ –∑–∞–º–µ—Ç–∫–∏?")){
    localStorage.removeItem(STORAGE_KEY);
    for(const k in state) delete state[k];
    render();
  }
});
$("#btnPrint").addEventListener("click", ()=>window.print());
$("#btnExport").addEventListener("click", ()=>{
  const blob = new Blob([JSON.stringify(state,null,2)], {type:"application/json"});
  const url = URL.createObjectURL(blob);
  const a = Object.assign(document.createElement("a"), {href:url, download:"checklist-progress.json"});
  document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
});
$("#fileImport").addEventListener("change", e=>{
  const f = e.target.files?.[0]; if(!f) return;
  const r = new FileReader();
  r.onload = ()=>{ try{
      const imp = JSON.parse(String(r.result));
      if(typeof imp === "object"){ localStorage.setItem(STORAGE_KEY, JSON.stringify(imp)); Object.assign(state, imp); render(); alert("–ü—Ä–æ–≥—Ä–µ—Å—Å –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω."); }
      else throw 0;
    }catch(_){ alert("–ù–µ —É–¥–∞–ª–æ—Å—å –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç JSON."); }
  };
  r.readAsText(f); e.target.value = "";
});
</script>
</body>
</html>
