<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>–ü—Ä–∞–∫—Ç–∏–∫–∞ ‚Äî –°–∫–∞–Ω–µ—Ä –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞: —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å ¬´–æ–¥–Ω–æ–¥–Ω–µ–≤–∫—É¬ª</title>
<meta name="color-scheme" content="light only">
<style>
  :root{
    --bg:#ffffff; --text:#0f1c3f; --muted:#606b86; --soft:#f4f6fa; --card:#ffffff; --accent:#d31f2b;
    --ok:#1f8f4e; --warn:#c77800; --bad:#a00017; --border:#e6e9ef;
    --shadow:0 10px 24px rgba(15,28,63,.06), 0 2px 6px rgba(15,28,63,.05);
    --radius:18px;
  }
  html,body{margin:0;background:var(--bg);color:var(--text);font:16px/1.65 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}
  .wrap{max-width:1160px;margin:0 auto;padding:28px 18px 80px}
  h1{font-size:28px;margin:0 0 8px}
  h2{font-size:22px;margin:0 0 10px}
  h3{font-size:18px;margin:12px 0 8px}
  p{margin:8px 0}
  .hero{background:linear-gradient(180deg,#fff,#fafbfd);border:1px solid var(--border);border-radius:24px;padding:24px;box-shadow:var(--shadow)}
  .badges{display:flex;gap:10px;flex-wrap:wrap;margin-top:8px}
  .badge{font-size:13px;color:var(--muted);background:var(--soft);border:1px solid var(--border);border-radius:999px;padding:5px 10px}
  .grid{display:grid;gap:18px}
  @media (min-width:900px){ .cols-2{grid-template-columns:1fr 1fr} .cols-3{grid-template-columns:repeat(3,1fr)} }
  .card{background:var(--card);border:1px solid var(--border);border-radius:var(--radius);padding:18px;box-shadow:var(--shadow)}
  .soft{background:var(--soft);border:1px dashed var(--border)}
  .note{color:var(--muted);font-size:14px}
  .toolbar{display:flex;flex-wrap:wrap;gap:8px;margin-top:8px}
  button{appearance:none;border:1px solid var(--border);background:#fff;border-radius:12px;padding:10px 14px;font-weight:650;cursor:pointer;transition:.2s}
  button:hover{transform:translateY(-1px);box-shadow:var(--shadow)}
  .btn-accent{background:var(--accent);color:#fff;border-color:transparent}
  .pill{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border-radius:999px;border:1px solid var(--border);background:var(--soft);font-size:13px;color:var(--muted);margin:4px 6px 0 0}
  .pill.bad{background:#fff1f3;border-color:#ffd7de;color:var(--bad)}
  .pill.warn{background:#fff7ea;border-color:#ffe3bd;color:var(--warn)}
  .pill.ok{background:#eef9f3;border-color:#dff1e7;color:var(--ok)}
  .pair{display:flex;gap:10px;align-items:center}
  .kv{display:grid;grid-template-columns:140px 1fr;gap:6px}
  .kv b{color:#253163}
  .flag{display:flex;gap:12px;align-items:flex-start;padding:10px 12px;border-radius:12px;border:1px dashed var(--border);background:#fff;margin:8px 0}
  .chip{display:inline-block;padding:6px 10px;border-radius:999px;border:1px solid var(--border);background:#fff;font-size:13px}
  /* —Ä–∏—Å–∫-–º–µ—Ç—Ä */
  .risk{display:grid;grid-template-columns:120px 1fr;gap:12px;align-items:center;margin-top:6px}
  .bar{height:12px;border-radius:999px;background:#edf0f6;position:relative;overflow:hidden;border:1px solid var(--border)}
  .needle{position:absolute;left:0;top:0;height:100%;width:0;background:linear-gradient(90deg,#15a24a,#ffc400,#ff5a67)}
  .risk .score{font-weight:800}
  /* —á–µ–∫-–ª–∏—Å—Ç */
  .checklist{display:grid;gap:10px}
  .check{display:grid;grid-template-columns:auto 1fr auto;gap:10px;align-items:flex-start;border:1px solid var(--border);border-radius:12px;padding:10px;background:#fff}
  .check input[type="checkbox"]{transform:scale(1.15);margin-top:4px}
  .weight{font-size:12px;color:var(--muted)}
  /* drag & drop */
  .dnd{display:grid;gap:10px}
  .dnd-row{display:grid;grid-template-columns:1fr 1fr;gap:10px}
  .drag-items,.drop-zones{display:grid;gap:10px}
  .drag{padding:10px;border:1px solid var(--border);border-radius:12px;background:#fff;cursor:grab;user-select:none}
  .zone{min-height:58px;border:2px dashed #cbd3e3;border-radius:12px;padding:10px;background:#fbfcff}
  .zone.filled{border-color:#a3b0cc;background:#f2f5fb}
  .zone h4{margin:0 0 6px;font-size:14px;color:#334}
  .drag.correct{background:#eef9f3;border-color:#dff1e7}
  .drag.wrong{background:#fff1f3;border-color:#ffd7de}
  .sr-only{position:absolute !important;height:1px;width:1px;overflow:hidden;clip:rect(1px,1px,1px,1px)}
  /* –æ—Ç—á—ë—Ç */
  textarea.report{width:100%;min-height:160px;border:1px solid var(--border);border-radius:12px;padding:12px;font-family:ui-monospace,Consolas,monospace}
  .status{font-size:13px;color:var(--muted)}
  /* –ø–µ—á–∞—Ç—å */
  @media print{button{display:none !important} .card{break-inside:avoid}}
</style>
</head>
<body>
<div class="wrap" id="app">
  <section class="hero">
    <h1>–ü—Ä–∞–∫—Ç–∏–∫–∞: üéØ –°–∫–∞–Ω–µ—Ä –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞ ‚Äî —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å ¬´–æ–¥–Ω–æ–¥–Ω–µ–≤–∫—É¬ª</h1>
    <p>–í—ã —Ä–∞–∑–±–µ—Ä—ë—Ç–µ –∫–∞—Ä—Ç–æ—á–∫—É –∫–æ–º–ø–∞–Ω–∏–∏, –æ—Ç–º–µ—Ç–∏—Ç–µ ¬´–∫—Ä–∞—Å–Ω—ã–µ —Ñ–ª–∞–≥–∏¬ª, —Å–æ–ø–æ—Å—Ç–∞–≤–∏—Ç–µ —Ñ–∞–∫—Ç—ã —Å –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏ —Å—Ñ–æ—Ä–º–∏—Ä—É–µ—Ç–µ —Ä–µ—à–µ–Ω–∏–µ: ‚úÖ —Å–æ—Ç—Ä—É–¥–Ω–∏—á–∞—Ç—å ¬∑ ‚ö†Ô∏è —Å –ø—Ä–µ–¥–æ—Ö—Ä–∞–Ω–∏—Ç–µ–ª—è–º–∏ ¬∑ ‚õî –æ—Ç–∫–∞–∑–∞—Ç—å—Å—è.</p>
    <div class="badges">
      <span class="badge">‚è± 20‚Äì30 –º–∏–Ω</span>
      <span class="badge">üß™ –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏: –∫–µ–π—Å + —á–µ–∫-–ª–∏—Å—Ç + dnd</span>
      <span class="badge">üíæ –ü—Ä–æ–≥—Ä–µ—Å—Å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è</span>
    </div>
    <div class="toolbar">
      <button class="btn-accent" id="btnNew">üîÑ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–π –∫–µ–π—Å</button>
      <button id="btnReset">‚ôªÔ∏è –°–±—Ä–æ—Å–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å</button>
      <button id="btnPrint">üñ®Ô∏è –ü–µ—á–∞—Ç—å / PDF</button>
    </div>
  </section>

  <!-- –ê–ö–¢–ò–í–ù–û–°–¢–¨ 1: –ö–∞—Ä—Ç–æ—á–∫–∞ –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞ -->
  <section class="card" id="caseCard" aria-labelledby="caseTitle">
    <h2 id="caseTitle">1) üß© –ö–µ–π—Å: –∏–∑—É—á–∏—Ç–µ –∫–∞—Ä—Ç–æ—á–∫—É –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞</h2>
    <div id="caseBody" class="grid cols-2">
      <!-- –ª–µ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ ‚Äî –ø—Ä–æ—Ñ–∏–ª—å -->
      <div class="soft" style="border-radius:14px;padding:14px">
        <h3>üìá –ü—Ä–æ—Ñ–∏–ª—å</h3>
        <div class="kv"><b>–ù–∞–∑–≤–∞–Ω–∏–µ:</b><div id="c_name">‚Äî</div></div>
        <div class="kv"><b>–ò–ù–ù / –û–ì–†–ù:</b><div id="c_ids">‚Äî</div></div>
        <div class="kv"><b>–í–æ–∑—Ä–∞—Å—Ç:</b><div id="c_age">‚Äî</div></div>
        <div class="kv"><b>–ê–¥—Ä–µ—Å:</b><div id="c_addr">‚Äî</div></div>
        <div class="kv"><b>–î–∏—Ä–µ–∫—Ç–æ—Ä:</b><div id="c_ceo">‚Äî</div></div>
        <div class="kv"><b>–£—á—Ä–µ–¥–∏—Ç–µ–ª–∏:</b><div id="c_owners">‚Äî</div></div>
        <div class="kv"><b>–û–ö–í–≠–î:</b><div id="c_okved">‚Äî</div></div>
        <div class="kv"><b>–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏:</b><div id="c_staff">‚Äî</div></div>
      </div>
      <!-- –ø—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ ‚Äî –æ–ø–µ—Ä–∞—Ü–∏–∏/–Ω–∞–ª–æ–≥–∏ -->
      <div class="soft" style="border-radius:14px;padding:14px">
        <h3>üìä –û–ø–µ—Ä–∞—Ü–∏–∏ –∏ –Ω–∞–ª–æ–≥–∏</h3>
        <div class="kv"><b>–û–±–æ—Ä–æ—Ç—ã:</b><div id="c_turn">‚Äî</div></div>
        <div class="kv"><b>–ù–∞–ª–æ–≥–∏/–æ–±–æ—Ä–æ—Ç:</b><div id="c_tax">‚Äî</div></div>
        <div class="kv"><b>–û–±–Ω–∞–ª/–Ω–∞–ª–∏—á–∫–∞:</b><div id="c_cash">‚Äî</div></div>
        <div class="kv"><b>–¢—Ä–∞–Ω–∑–∏—Ç—ã:</b><div id="c_transit">‚Äî</div></div>
        <div class="kv"><b>–°—É–¥—ã:</b><div id="c_courts">‚Äî</div></div>
        <div class="kv"><b>–°–∞–π—Ç/—Å–ª–µ–¥:</b><div id="c_web">‚Äî</div></div>
        <div class="kv"><b>–ü—Ä–∏–º–µ—á–∞–Ω–∏—è:</b><div id="c_notes">‚Äî</div></div>
      </div>
    </div>
    <p class="note">–ü–æ–¥—Å–∫–∞–∑–∫–∞: –º—ã—Å–ª–µ–Ω–Ω–æ —Å–æ–ø–æ—Å—Ç–∞–≤—å—Ç–µ –¥–∞–Ω–Ω—ã–µ —Å –æ—Ç–∫—Ä—ã—Ç—ã–º–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏ (–§–ù–° ¬´–ü—Ä–æ–∑—Ä–∞—á–Ω—ã–π –±–∏–∑–Ω–µ—Å¬ª, –ì–ò–† –ë–û, Rusprofile, –ö–ê–î ¬´–ê—Ä–±–∏—Ç—Ä¬ª, —Å–µ—Ä–≤–∏—Å –¶–ë ¬´–ó–Ω–∞–π —Å–≤–æ–µ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞¬ª).</p>
  </section>

  <!-- –ê–ö–¢–ò–í–ù–û–°–¢–¨ 2: –ß–µ–∫-–ª–∏—Å—Ç —Å –≤–µ—Å–∞–º–∏ –∏ —Ä–∏—Å–∫–æ–º–µ—Ç—Ä–æ–º -->
  <section class="card" id="checklistCard" aria-labelledby="chkTitle">
    <h2 id="chkTitle">2) ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç ¬´–∫—Ä–∞—Å–Ω—ã—Ö —Ñ–ª–∞–≥–æ–≤¬ª (–æ—Ü–µ–Ω–∏—Ç–µ –ø–æ –∫–µ–π—Å—É)</h2>
    <div class="risk" aria-live="polite">
      <div class="score" id="riskScore">–†–∏—Å–∫: 0 / 100</div>
      <div class="bar"><div class="needle" id="riskNeedle"></div></div>
    </div>
    <div class="checklist" id="checklist">
      <!-- –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —Å–∫—Ä–∏–ø—Ç–æ–º -->
    </div>
    <p class="note">üòé –ü–æ–¥—Ö–æ–¥: —É—á–∏—Ç—ã–≤–∞–µ–º –Ω–µ –æ–¥–∏–Ω –ø—Ä–∏–∑–Ω–∞–∫, –∞ —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç—å. –í–µ—Å ‚Äî –∑–Ω–∞—á–∏–º–æ—Å—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ (—á–µ–º –≤—ã—à–µ, —Ç–µ–º ¬´–∫—Ä–∞—Å–Ω–µ–µ¬ª).</p>
  </section>

  <!-- –ê–ö–¢–ò–í–ù–û–°–¢–¨ 3: DnD —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ -->
  <section class="card" id="dndCard" aria-labelledby="dndTitle">
    <h2 id="dndTitle">3) üß† –°–æ–ø–æ—Å—Ç–∞–≤—å—Ç–µ —Ñ–∞–∫—Ç ‚Üî –∏—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–æ–≤–µ—Ä–∫–∏ (–ø–µ—Ä–µ—Ç–∞—â–∏—Ç–µ)</h2>
    <div class="dnd">
      <div class="dnd-row">
        <div class="drag-items" id="dragItems" aria-label="–§–∞–∫—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏">
          <!-- drag items -->
        </div>
        <div class="drop-zones" id="dropZones" aria-label="–ò—Å—Ç–æ—á–Ω–∏–∫–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏">
          <!-- drop zones -->
        </div>
      </div>
      <div class="toolbar">
        <button id="btnCheckDnD" class="btn-accent">‚úîÔ∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ</button>
        <span class="status" id="dndStatus" role="status" aria-live="polite"></span>
      </div>
    </div>
  </section>

  <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç –∏ –æ—Ç—á–µ—Ç -->
  <section class="card" id="reportCard" aria-labelledby="repTitle">
    <h2 id="repTitle">4) üìù –ò—Ç–æ–≥: —Ä–µ—à–µ–Ω–∏–µ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</h2>
    <div class="pair">
      <div id="decisionPills"></div>
    </div>
    <h3>–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–∏–Ω–∏-–æ—Ç—á—ë—Ç</h3>
    <textarea class="report" id="reportText" spellcheck="false"></textarea>
    <div class="toolbar">
      <button id="btnCopy">üìã –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –æ—Ç—á—ë—Ç</button>
      <span class="status" id="copyStatus">–í—ã —Ç–∞–∫–∂–µ –º–æ–∂–µ—Ç–µ –≤—ã–¥–µ–ª–∏—Ç—å —Ç–µ–∫—Å—Ç –≤—Ä—É—á–Ω—É—é –∏ –Ω–∞–∂–∞—Ç—å Ctrl/Cmd+C.</span>
    </div>
  </section>

  <section class="card soft">
    <h2>üîó –ü–æ–ª–µ–∑–Ω–æ –¥–ª—è –ø—Ä–∞–∫—Ç–∏–∫–∏</h2>
    <p class="note">üåê –§–ù–° ¬´–ü—Ä–æ–∑—Ä–∞—á–Ω—ã–π –±–∏–∑–Ω–µ—Å¬ª ¬∑ –ì–ò–† –ë–û ¬∑ Rusprofile ¬∑ –ö–ê–î ¬´–ê—Ä–±–∏—Ç—Ä¬ª ¬∑ –ì–ê–° ¬´–ü—Ä–∞–≤–æ—Å—É–¥–∏–µ¬ª ¬∑ –¶–ë ¬´–ó–Ω–∞–π —Å–≤–æ–µ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞¬ª ‚Äî –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ —Ä–µ–∞–ª—å–Ω—ã–º –∫–µ–π—Å–∞–º —Å–≤–æ–∏—Ö –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤.</p>
  </section>
</div>

<script>
/* ==========
   –î–ê–ù–ù–´–ï –ö–ï–ô–°–û–í
   ========== */
const CASES = [
  {
    name: "–û–û–û ¬´–ò–Ω—Ç–µ–≥—Ä–æ –ú–∞—Ä–∫–µ—Ç¬ª",
    ids: "–ò–ù–ù 7712‚Ä¢‚Ä¢‚Ä¢ / –û–ì–†–ù 1.2 –º–ª–Ω —Å–µ—Ä–∏—è",
    age: "8 –º–µ—Å—è—Ü–µ–≤ (—Ä–µ–≥. ‚Äî –Ω–µ–¥–∞–≤–Ω–æ)",
    addr: "–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –ü—Ä–∏–º–µ—Ä–Ω–∞—è, –¥.5 ‚Äî –∞–¥—Ä–µ—Å –≤ –∫–æ–≤–æ—Ä–∫–∏–Ω–≥–µ (–º–∞—Å—Å–æ–≤—ã–π)",
    ceo: "–ò–≤–∞–Ω–æ–≤ –°.–í. (—Ä—É–∫. –≤ 22 –∫–æ–º–ø–∞–Ω–∏—è—Ö)",
    owners: "–î–≤–∞ —Ñ–∏–∑–ª–∏—Ü–∞, –ø–æ 50%",
    okved: "62.01, 73.11, 73.20 ‚Äî IT + –º–∞—Ä–∫–µ—Ç–∏–Ω–≥",
    staff: "1‚Äì2 —á–µ–ª., –§–û–¢ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π",
    turn: "–û–±–æ—Ä–æ—Ç—ã –≤—ã—Å–æ–∫–∏–µ (20‚Äì30 –º–ª–Ω/–º–µ—Å.)",
    tax: "–ù–∞–ª–æ–≥–∏/–æ–±–æ—Ä–æ—Ç ~0,4%",
    cash: "–†–µ–≥—É–ª—è—Ä–Ω—ã–µ —Å–Ω—è—Ç–∏—è –Ω–∞–ª–∏—á–Ω—ã—Ö",
    transit: "–ï—Å—Ç—å ¬´–ø–æ—Å—Ç—É–ø–∏–ª–æ ‚Üí —Å—Ä–∞–∑—É —É—à–ª–æ¬ª",
    courts: "–°–ø–æ—Ä –ø–æ –≤–∑—ã—Å–∫–∞–Ω–∏—é 1,8 –º–ª–Ω (–ö–ê–î)",
    web: "–°–∞–π—Ç-–≤–∏–∑–∏—Ç–∫–∞, –∫–µ–π—Å—ã –Ω–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é—Ç—Å—è",
    notes: "–ü–ª–∞—Ç—ë–∂ ¬´–∑–∞ –ª–æ–≥–∏—Å—Ç–∏–∫—É¬ª, —Ö–æ—Ç—è –û–ö–í–≠–î ‚Äî IT/–º–∞—Ä–∫–µ—Ç–∏–Ω–≥",
    // –ø–æ–¥—Å–∫–∞–∑–∫–∏ –¥–ª—è —á–µ–∫-–ª–∏—Å—Ç–∞
    hints: ["mass_addr","mass_ceo","low_tax","cash","transit","mismatch","young","no_staff"]
  },
  {
    name: "–û–û–û ¬´–°–∫–ª–∞–¥–ü–æ—Å—Ç–∞–≤–∫–∞¬ª",
    ids: "–ò–ù–ù 7810‚Ä¢‚Ä¢‚Ä¢ / –û–ì–†–ù 1.1 –º–ª–Ω —Å–µ—Ä–∏—è",
    age: "3 –≥–æ–¥–∞",
    addr: "–°–ü–±, –ø—Ä. –õ–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–∏–π, 10 ‚Äî —Å–∫–ª–∞–¥ 3PL (–Ω–µ –º–∞—Å—Å–æ–≤—ã–π)",
    ceo: "–ü–µ—Ç—Ä–æ–≤ –ê.–ù. (1‚Äì2 —é—Ä–ª–∏—Ü–∞)",
    owners: "–û–¥–∏–Ω —É—á—Ä–µ–¥–∏—Ç–µ–ª—å",
    okved: "46.49 ‚Äî –æ–ø—Ç–æ–≤–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è",
    staff: "15‚Äì20 —á–µ–ª., –§–û–¢ —Å–æ—Ä–∞–∑–º–µ—Ä–µ–Ω",
    turn: "–û–±–æ—Ä–æ—Ç—ã —Å—Ç–∞–±–∏–ª—å–Ω—ã–µ (5‚Äì7 –º–ª–Ω/–º–µ—Å.)",
    tax: "–ù–∞–ª–æ–≥–∏/–æ–±–æ—Ä–æ—Ç ~1,4%",
    cash: "–ù–∞–ª –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è",
    transit: "–¢—Ä–∞–Ω–∑–∏—Ç–æ–≤ –Ω–µ –Ω–∞–±–ª—é–¥–∞–µ—Ç—Å—è",
    courts: "–¢–µ–∫—É—â–∏—Ö —Å–ø–æ—Ä–æ–≤ –Ω–µ—Ç",
    web: "–°–∞–π—Ç, —Ñ–æ—Ç–æ —Å–∫–ª–∞–¥–∞, –∫–æ–Ω—Ç–∞–∫—Ç—ã, –æ—Ç–∑—ã–≤—ã",
    notes: "–î–æ–∫—É–º–µ–Ω—Ç—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç—Å—è –∑–∞—Ä–∞–Ω–µ–µ",
    hints: []
  },
  {
    name: "–û–û–û ¬´–ê–ª—å—Ñ–∞-–°–µ—Ä–≤–∏—Å¬ª",
    ids: "–ò–ù–ù 5408‚Ä¢‚Ä¢‚Ä¢ / –û–ì–†–ù 1.0 –º–ª–Ω —Å–µ—Ä–∏—è",
    age: "1 –≥–æ–¥ –∏ 2 –º–µ—Å—è—Ü–∞",
    addr: "–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫, —É–ª. –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è, 12 ‚Äî –æ—Ñ–∏—Å (–º–∞—Å—Å–æ–≤—ã–π)",
    ceo: "–°–º–∏—Ä–Ω–æ–≤ –î.–ê. (—Ä—É–∫. –≤ 18 –∫–æ–º–ø–∞–Ω–∏—è—Ö)",
    owners: "–§–∏–∑–ª–∏—Ü–æ 100%",
    okved: "43.29 ‚Äî –ø—Ä–æ—á–∏–µ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–∞–±–æ—Ç—ã",
    staff: "–ù–µ—Ç –ù–î–§–õ/–≤–∑–Ω–æ—Å–æ–≤",
    turn: "–û–±–æ—Ä–æ—Ç—ã —Å–∫–∞—á–∫–æ–æ–±—Ä–∞–∑–Ω—ã–µ (–¥–æ 12 –º–ª–Ω/–º–µ—Å.)",
    tax: "–ù–∞–ª–æ–≥–∏/–æ–±–æ—Ä–æ—Ç ~0,6%",
    cash: "–ö—Ä—É–ø–Ω—ã–µ —Å–Ω—è—Ç–∏—è –ø–æ—Å–ª–µ –∑–∞—á–∏—Å–ª–µ–Ω–∏–π",
    transit: "¬´–ü–æ–ª—É—á–∏–ª-–ø–µ—Ä–µ–≤—ë–ª¬ª –Ω–∞ —É—Å–ª—É–≥–∏ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–∞",
    courts: "–ï—Å—Ç—å –¥–µ–ª–æ –æ —Ñ–∏–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Å–¥–µ–ª–∫–∏",
    web: "–°–∞–π—Ç–∞ –Ω–µ—Ç",
    notes: "–ù–∞–∑–Ω–∞—á–µ–Ω–∏—è –ø–ª–∞—Ç–µ–∂–µ–π –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –¥–æ–≥–æ–≤–æ—Ä—É",
    hints: ["mass_addr","mass_ceo","no_staff","low_tax","cash","transit","mismatch","spory"]
  },
  {
    name: "–û–û–û ¬´–ë–µ—Ç–∞-–¢–µ—Ö¬ª",
    ids: "–ò–ù–ù 5032‚Ä¢‚Ä¢‚Ä¢ / –û–ì–†–ù 1.3 –º–ª–Ω —Å–µ—Ä–∏—è",
    age: "6 –ª–µ—Ç",
    addr: "–≥. –¢—É–ª–∞, –ø—Ä–æ–º–∑–æ–Ω–∞ ‚Äî —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–µ –ø–æ–º–µ—â–µ–Ω–∏–µ",
    ceo: "–û—Ä–ª–æ–≤–∞ –ú.–í. (1 —é—Ä–ª–∏—Ü–æ)",
    owners: "2 —É—á—Ä–µ–¥–∏—Ç–µ–ª—è",
    okved: "28.99 ‚Äî –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è",
    staff: "40+ —á–µ–ª., –§–û–¢ –≤—ã—Å–æ–∫–∏–π",
    turn: "–û–±–æ—Ä–æ—Ç—ã –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º—ã–µ",
    tax: "–ù–∞–ª–æ–≥–∏/–æ–±–æ—Ä–æ—Ç ~2,2%",
    cash: "–ù–∞–ª ‚Äî —Ç–æ–ª—å–∫–æ –ø–æ–¥ —Ö–æ–∑—è–π—Å—Ç–≤–µ–Ω–Ω—ã–µ –Ω—É–∂–¥—ã –ø–æ –æ—Ç—á—ë—Ç–∞–º",
    transit: "–ù–µ—Ç —Ç—Ä–∞–Ω–∑–∏—Ç–æ–≤",
    courts: "–ü–ª–∞–Ω–æ–≤—ã–µ —Å–ø–æ—Ä—ã (–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ)",
    web: "–°–∞–π—Ç, –∫–µ–π—Å—ã, —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã",
    notes: "–ü–æ–ª–Ω—ã–π –∫–æ–º–ø–ª–µ–∫—Ç –ø–µ—Ä–≤–∏—á–∫–∏",
    hints: []
  }
];

// —á–µ–∫-–ª–∏—Å—Ç: –∫–ª—é—á, —Ç–µ–∫—Å—Ç, –≤–µ—Å
const CHECKS = [
  {key:"mass_addr", text:"üè¢ –ú–∞—Å—Å–æ–≤—ã–π –∞–¥—Ä–µ—Å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ / –Ω–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω–æ–≥–æ –æ—Ñ–∏—Å–∞", weight:12},
  {key:"mass_ceo", text:"üßë‚Äçüíº –î–∏—Ä–µ–∫—Ç–æ—Ä/—É—á—Ä–µ–¥–∏—Ç–µ–ª—å –≤ –¥–µ—Å—è—Ç–∫–∞—Ö —Ñ–∏—Ä–º / —á–∞—Å—Ç–∞—è —Ä–æ—Ç–∞—Ü–∏—è", weight:12},
  {key:"young", text:"üÜï –ö–æ—Ä–æ—Ç–∫–∏–π —Å—Ä–æ–∫ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è (‚â§ 1‚Äì2 –ª–µ—Ç)", weight:6},
  {key:"no_staff", text:"üë• –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ (–ù–î–§–õ/–≤–∑–Ω–æ—Å—ã –Ω–µ –≤–∏–¥–Ω—ã)", weight:10},
  {key:"low_tax", text:"üìâ –ê–Ω–æ–º–∞–ª—å–Ω–æ –Ω–∏–∑–∫–∞—è –Ω–∞–ª–æ–≥–æ–≤–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ (~< 0,9% –ø—Ä–∏ –∫—Ä—É–ø–Ω—ã—Ö –æ–±–æ—Ä–æ—Ç–∞—Ö)", weight:12},
  {key:"cash", text:"üí∏ –ß—Ä–µ–∑–º–µ—Ä–Ω–æ–µ –æ–±–Ω–∞–ª–∏—á–∏–≤–∞–Ω–∏–µ / –∫—Ä—É–ø–Ω—ã–µ —Å–Ω—è—Ç–∏—è –±–µ–∑ –ø–µ—Ä–≤–∏—á–∫–∏", weight:10},
  {key:"transit", text:"üîÅ –¢—Ä–∞–Ω–∑–∏—Ç–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ ¬´–ø–æ—Å—Ç—É–ø–∏–ª–æ ‚Üí —Å—Ä–∞–∑—É —É—à–ª–æ¬ª", weight:12},
  {key:"mismatch", text:"üß≠ –ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ø–ª–∞—Ç–µ–∂–µ–π –û–ö–í–≠–î/–¥–æ–≥–æ–≤–æ—Ä—É; —Å—Ç—Ä–∞–Ω–Ω—ã–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è", weight:10},
  {key:"spory", text:"‚öñÔ∏è –°—É–¥–µ–±–Ω—ã–µ –¥–µ–ª–∞ –æ —Ñ–∏–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ / –±–∞–Ω–∫—Ä–æ—Ç—Å—Ç–≤–µ", weight:8},
  {key:"no_web", text:"üåê –ù–µ—Ç —Å–∞–π—Ç–∞/–∫–µ–π—Å–æ–≤/—Ü–∏—Ñ—Ä–æ–≤–æ–≥–æ —Å–ª–µ–¥–∞", weight:6},
];

const DND_SOURCES = [
  {id:"pb", label:"–§–ù–° ¬´–ü—Ä–æ–∑—Ä–∞—á–Ω—ã–π –±–∏–∑–Ω–µ—Å¬ª (–ï–ì–†–Æ–õ/–ï–ì–†–ò–ü, –º–∞—Å—Å–æ–≤—ã–µ –∞–¥—Ä–µ—Å–∞)", accepts:["mass_addr","young","no_staff"]},
  {id:"bo", label:"–ì–ò–† –ë–û (–±—É—Ö–æ—Ç—á—ë—Ç–Ω–æ—Å—Ç—å, –∞—É–¥–∏—Ç–æ—Ä—Å–∫–∏–µ –∑–∞–∫–ª—é—á–µ–Ω–∏—è)", accepts:["low_tax"]},
  {id:"rp", label:"Rusprofile (—Å–≤—è–∑–∏, –º–∞—Å—Å–æ–≤–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ)", accepts:["mass_ceo"]},
  {id:"kad", label:"–ö–ê–î ¬´–ê—Ä–±–∏—Ç—Ä¬ª / –ì–ê–° ¬´–ü—Ä–∞–≤–æ—Å—É–¥–∏–µ¬ª (—Å—É–¥—ã)", accepts:["spory"]},
  {id:"web", label:"–û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Å–∞–π—Ç/—Ü–∏—Ñ—Ä–æ–≤–æ–π —Å–ª–µ–¥", accepts:["no_web","mismatch"]},
  {id:"logic", label:"–õ–æ–≥–∏–∫–∞ –æ–ø–µ—Ä–∞—Ü–∏–π/–ø–µ—Ä–≤–∏—á–∫–∞ (–¥–æ–≥–æ–≤–æ—Ä—ã, –¢–ó, –∞–∫—Ç—ã)", accepts:["transit","cash","mismatch"]},
];

const DND_FACTS = [
  {key:"mass_addr", text:"üè¢ –ú–∞—Å—Å–æ–≤—ã–π –∞–¥—Ä–µ—Å / –∫–æ–≤–æ—Ä–∫–∏–Ω–≥ –±–µ–∑ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è"},
  {key:"mass_ceo", text:"üßë‚Äçüíº –î–∏—Ä–µ–∫—Ç–æ—Ä –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –≤ 20+ —Ñ–∏—Ä–º–∞—Ö"},
  {key:"low_tax", text:"üìâ –ù–∞–ª–æ–≥–∏/–æ–±–æ—Ä–æ—Ç ~0,4‚Äì0,6% –ø—Ä–∏ –∫—Ä—É–ø–Ω—ã—Ö –æ–±–æ—Ä–æ—Ç–∞—Ö"},
  {key:"transit", text:"üîÅ ¬´–ü–æ—Å—Ç—É–ø–∏–ª–æ ‚Üí —Å—Ä–∞–∑—É —É—à–ª–æ¬ª (—Ü–µ–ø–æ—á–∫–∏)"},
  {key:"cash", text:"üí∏ –ö—Ä—É–ø–Ω—ã–µ —Å–Ω—è—Ç–∏—è –Ω–∞–ª–∏—á–Ω—ã—Ö –±–µ–∑ –ø–µ—Ä–≤–∏—á–∫–∏"},
  {key:"spory", text:"‚öñÔ∏è –°–ø–æ—Ä –æ —Ñ–∏–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ / –≤–∑—ã—Å–∫–∞–Ω–∏—è –º–∏–ª–ª–∏–æ–Ω—ã"},
  {key:"mismatch", text:"üß≠ –ü–ª–∞—Ç—ë–∂ ¬´–∑–∞ –ª–æ–≥–∏—Å—Ç–∏–∫—É¬ª –ø—Ä–∏ –û–ö–í–≠–î IT/–º–∞—Ä–∫–µ—Ç–∏–Ω–≥"},
  {key:"no_staff", text:"üë• –ù–µ—Ç –ù–î–§–õ/–≤–∑–Ω–æ—Å–æ–≤ (—à—Ç–∞—Ç –Ω–µ –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç—Å—è)"},
  {key:"young", text:"üÜï –ö–æ–º–ø–∞–Ω–∏—è –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∞ –Ω–µ–¥–∞–≤–Ω–æ"},
  {key:"no_web", text:"üåê –°–∞–π—Ç–∞/–∫–µ–π—Å–æ–≤ –Ω–µ—Ç"},
];

/* ==========
   –°–û–°–¢–û–Ø–ù–ò–ï + –£–¢–ò–õ–ò–¢–´
   ========== */
const LS_KEY = "odnd_practice_v1";
let state = {
  caseIndex: 0,
  checks: {},      // {key: boolean}
  dnd: {},         // {factKey: sourceId}
};

function saveState(){ localStorage.setItem(LS_KEY, JSON.stringify(state)); }
function loadState(){
  try{
    const raw = localStorage.getItem(LS_KEY);
    if(raw){ state = {...state, ...JSON.parse(raw)}; }
  }catch(e){}
}
function resetState(){
  state = { caseIndex: 0, checks:{}, dnd:{} };
  saveState();
}

/* ==========
   –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø UI
   ========== */
const el = (sel) => document.querySelector(sel);
const els = (sel) => Array.from(document.querySelectorAll(sel));

function renderCase(){
  const c = CASES[state.caseIndex];
  el("#c_name").textContent = c.name;
  el("#c_ids").textContent = c.ids;
  el("#c_age").textContent = c.age;
  el("#c_addr").textContent = c.addr;
  el("#c_ceo").textContent = c.ceo;
  el("#c_owners").textContent = c.owners;
  el("#c_okved").textContent = c.okved;
  el("#c_staff").textContent = c.staff;
  el("#c_turn").textContent = c.turn;
  el("#c_tax").textContent = c.tax;
  el("#c_cash").textContent = c.cash;
  el("#c_transit").textContent = c.transit;
  el("#c_courts").textContent = c.courts;
  el("#c_web").textContent = c.web;
  el("#c_notes").textContent = c.notes;
}

function renderChecklist(){
  const box = el("#checklist");
  box.innerHTML = "";
  CHECKS.forEach(ch=>{
    const row = document.createElement("div");
    row.className = "check";
    const input = document.createElement("input");
    input.type="checkbox"; input.id="chk_"+ch.key; input.checked = !!state.checks[ch.key];
    input.addEventListener("change", ()=>{
      state.checks[ch.key] = input.checked;
      saveState();
      updateRisk();
      buildReport();
    });
    const label = document.createElement("label");
    label.setAttribute("for", input.id);
    label.textContent = ch.text;
    const weight = document.createElement("div");
    weight.className="weight";
    weight.textContent = `–≤–µ—Å: +${ch.weight}`;
    row.appendChild(input); row.appendChild(label); row.appendChild(weight);
    box.appendChild(row);
  });

  // –∞–≤—Ç–æ-–ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ–¥—Å–∫–∞–∑–æ–∫ –∏–∑ –∫–µ–π—Å–∞ (–Ω–µ –æ—Ç–º–µ—á–∞–µ–º, —Ç–æ–ª—å–∫–æ –ø–æ–¥—Å–≤–µ—Ç–∫–∞ —Å–æ–≤–µ—Ç–æ–º)
  const hints = new Set(CASES[state.caseIndex].hints);
  CHECKS.forEach(ch=>{
    if(hints.has(ch.key)){
      const label = el(`#chk_${ch.key} + label`);
      if(label) label.innerHTML += ' <span class="pill warn">üõà –ø–æ–¥—Å–∫–∞–∑–∫–∞ –∏–∑ –∫–µ–π—Å–∞</span>';
    }
  });

  updateRisk();
}

function calcRisk(){
  let sum = 0;
  for(const ch of CHECKS){ if(state.checks[ch.key]) sum += ch.weight; }
  return Math.max(0, Math.min(100, sum));
}

function updateRisk(){
  const score = calcRisk();
  el("#riskScore").textContent = `–†–∏—Å–∫: ${score} / 100`;
  el("#riskNeedle").style.width = score + "%";
  buildDecision(score);
}

function buildDecision(score){
  const wrap = el("#decisionPills");
  wrap.innerHTML = "";
  let decision = "‚Äî";
  let pill = document.createElement("div");
  pill.className = "pill";
  if(score <= 25){
    pill.classList.add("ok");
    pill.textContent = "‚úÖ –†–µ—à–µ–Ω–∏–µ: —Å–æ—Ç—Ä—É–¥–Ω–∏—á–∞—Ç—å (–Ω–∏–∑–∫–∏–π —Ä–∏—Å–∫)";
    decision = "‚úÖ –°–æ—Ç—Ä—É–¥–Ω–∏—á–∞—Ç—å";
  }else if(score <= 55){
    pill.classList.add("warn");
    pill.textContent = "‚ö†Ô∏è –†–µ—à–µ–Ω–∏–µ: —Å–æ—Ç—Ä—É–¥–Ω–∏—á–∞—Ç—å —Å –ø—Ä–µ–¥–æ—Ö—Ä–∞–Ω–∏—Ç–µ–ª—è–º–∏";
    decision = "‚ö†Ô∏è –° –ø—Ä–µ–¥–æ—Ö—Ä–∞–Ω–∏—Ç–µ–ª—è–º–∏";
  }else{
    pill.classList.add("bad");
    pill.textContent = "‚õî –†–µ—à–µ–Ω–∏–µ: –æ—Ç–∫–∞–∑–∞—Ç—å—Å—è / –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –¥–æ –¥–æ–ø.–ø—Ä–æ–≤–µ—Ä–∫–∏";
    decision = "‚õî –û—Ç–∫–∞–∑/–ø–µ—Ä–µ–Ω–æ—Å";
  }
  wrap.appendChild(pill);
  wrap.dataset.decision = decision;
}

/* Drag & Drop */
function renderDnD(){
  const dragBox = el("#dragItems");
  const zoneBox = el("#dropZones");
  dragBox.innerHTML = ""; zoneBox.innerHTML = "";

  // —Ñ–∞–∫—Ç—ã
  DND_FACTS.forEach(f=>{
    const d = document.createElement("div");
    d.className = "drag";
    d.textContent = f.text;
    d.setAttribute("draggable","true");
    d.dataset.key = f.key;
    d.addEventListener("dragstart", onDragStart);
    d.addEventListener("dragend", onDragEnd);
    dragBox.appendChild(d);
  });

  // –∑–æ–Ω—ã
  DND_SOURCES.forEach(s=>{
    const z = document.createElement("div");
    z.className = "zone";
    z.dataset.source = s.id;
    z.innerHTML = `<h4>üìå ${s.label}</h4><div class="drop-here note">–ø–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Ñ–∞–∫—Ç—ã —Å—é–¥–∞</div>`;
    z.addEventListener("dragover", e=>{ e.preventDefault(); });
    z.addEventListener("drop", onDrop);
    zoneBox.appendChild(z);
  });

  // –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
  for(const [fact, src] of Object.entries(state.dnd||{})){
    const factEl = dragBox.querySelector(`.drag[data-key="${fact}"]`);
    const zone = zoneBox.querySelector(`.zone[data-source="${src}"]`);
    if(factEl && zone){ zone.appendChild(factEl); zone.classList.add("filled"); }
  }
}

let dragEl = null;
function onDragStart(e){ dragEl = e.target; e.dataTransfer.setData("text/plain", dragEl.dataset.key); }
function onDragEnd(){ dragEl = null; }
function onDrop(e){
  e.preventDefault();
  const key = e.dataTransfer.getData("text/plain");
  const zone = e.currentTarget;
  if(!key) return;
  const item = document.querySelector(`.drag[data-key="${key}"]`);
  if(item){
    zone.appendChild(item);
    zone.classList.add("filled");
    state.dnd[key] = zone.dataset.source;
    saveState();
  }
}

function checkDnD(){
  // –º–∞—Ä–∫–∏—Ä—É–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å
  els(".drag").forEach(d => { d.classList.remove("correct","wrong"); });
  let ok = 0, total = 0;
  for(const f of DND_FACTS){
    total++;
    const src = state.dnd[f.key];
    const found = DND_SOURCES.find(s=>s.id===src);
    if(found && found.accepts.includes(f.key)){ ok++; markDrag(f.key,true); } else { markDrag(f.key,false); }
  }
  const status = el("#dndStatus");
  status.textContent = `–†–µ–∑—É–ª—å—Ç–∞—Ç: ${ok} –∏–∑ ${total}`;
}

function markDrag(key, isOk){
  const d = document.querySelector(`.drag[data-key="${key}"]`);
  if(!d) return;
  d.classList.add(isOk ? "correct" : "wrong");
}

/* –û–¢–ß–Å–¢ */
function buildReport(){
  const c = CASES[state.caseIndex];
  const score = calcRisk();
  const decision = el("#decisionPills").dataset.decision || "‚Äî";
  const checked = CHECKS.filter(ch=>state.checks[ch.key]).map(ch=>"‚Ä¢ "+ch.text);
  const dndPairs = Object.entries(state.dnd).map(([fk,src])=>{
    const fact = DND_FACTS.find(f=>f.key===fk)?.text || fk;
    const srcL = DND_SOURCES.find(s=>s.id===src)?.label || src;
    return `‚Ä¢ ${fact} ‚Üí ${srcL}`;
  }).join("\n");
  const recs = (()=>{
    if(score <= 25){
      return [
        "‚úÖ –û—Ñ–æ—Ä–º–∏—Ç—å –¥–æ–≥–æ–≤–æ—Ä/–¢–ó/–∞–∫—Ç—ã –∑–∞—Ä–∞–Ω–µ–µ",
        "‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è –ø–ª–∞—Ç–µ–∂–µ–π —Å –¥–æ–≥–æ–≤–æ—Ä–æ–º",
        "‚úÖ –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–æ –§–ù–°/–ì–ò–† –ë–û/Rusprofile"
      ];
    }else if(score <= 55){
      return [
        "‚ö†Ô∏è –û–ø–ª–∞—Ç–∞ –ø–æ –≤–µ—Ö–∞–º, –∞–∫—Ç—ã —Å –¥–æ–∫–∞–∑—É–µ–º—ã–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏",
        "‚ö†Ô∏è –ë–∞–Ω–∫–æ–≤—Å–∫–∞—è –≥–∞—Ä–∞–Ω—Ç–∏—è/–∑–∞–ª–æ–≥ –ø—Ä–∏ –ø—Ä–µ–¥–æ–ø–ª–∞—Ç–µ",
        "‚ö†Ô∏è –§–æ—Ç–æ/–≤–∏–¥–µ–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ—Ñ–∏—Å–∞/—Å–∫–ª–∞–¥–∞, –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä—Å–æ–Ω–∞–ª–∞",
        "‚ö†Ô∏è –ü–∏—Å—å–º–µ–Ω–Ω—ã–µ –ø–æ—è—Å–Ω–µ–Ω–∏—è —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–æ–≥–æ —Å–º—ã—Å–ª–∞ –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π"
      ];
    }else{
      return [
        "‚õî –û—Ç–∫–∞–∑ / –ø–µ—Ä–µ–Ω–æ—Å –¥–æ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –∫—Ä–∞—Å–Ω—ã—Ö —Ñ–ª–∞–≥–æ–≤",
        "‚õî –ó–∞–ø—Ä–æ—Å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–≥–æ –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞",
        "‚õî –ü—Ä–æ–≤–µ—Å—Ç–∏ —É–≥–ª—É–±–ª—ë–Ω–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É: –±–µ–Ω–µ—Ñ–∏—Ü–∏–∞—Ä—ã, —Å—É–¥–µ–±–∫–∞, –æ—Ç—á—ë—Ç–Ω–æ—Å—Ç—å"
      ];
    }
  })();

  const txt =
`üéØ –°–∫–∞–Ω–µ—Ä –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞ ‚Äî –º–∏–Ω–∏-–æ—Ç—á—ë—Ç
===================================
–ö–æ–º–ø–∞–Ω–∏—è: ${c.name}
–ò–ù–ù/–û–ì–†–ù: ${c.ids}
–í–æ–∑—Ä–∞—Å—Ç/–∞–¥—Ä–µ—Å: ${c.age}; ${c.addr}
–î–∏—Ä–µ–∫—Ç–æ—Ä/—É—á—Ä–µ–¥–∏—Ç–µ–ª–∏: ${c.ceo}; ${c.owners}
–û–ö–í–≠–î: ${c.okved}
–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏: ${c.staff}
–û–ø–µ—Ä–∞—Ü–∏–∏/–Ω–∞–ª–æ–≥–∏: ${c.turn}; –Ω–∞–ª–æ–≥–∏/–æ–±–æ—Ä–æ—Ç: ${c.tax}
–ù–∞–ª/—Ç—Ä–∞–Ω–∑–∏—Ç—ã: ${c.cash}; ${c.transit}
–°—É–¥—ã/–≤–µ–±: ${c.courts}; ${c.web}
–ü—Ä–∏–º–µ—á–∞–Ω–∏—è: ${c.notes}

üîé –û—Ç–º–µ—á–µ–Ω–Ω—ã–µ ¬´–∫—Ä–∞—Å–Ω—ã–µ —Ñ–ª–∞–≥–∏¬ª (${checked.length} —à—Ç.):
${checked.join("\n") || "‚Äî"}

üß† –°–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Ñ–∞–∫—Ç ‚Üí –∏—Å—Ç–æ—á–Ω–∏–∫:
${dndPairs || "‚Äî"}

üìà –ò—Ç–æ–≥–æ–≤—ã–π —Ä–∏—Å–∫: ${score} / 100
üß≠ –†–µ—à–µ–Ω–∏–µ: ${decision}

üõ°Ô∏è –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
${recs.map(r=>"‚Ä¢ "+r).join("\n")}
`;
  el("#reportText").value = txt;
}

function copyReport(){
  const ta = el("#reportText");
  ta.select(); ta.setSelectionRange(0, 99999);
  let ok = false;
  try{ ok = document.execCommand("copy"); }catch(e){}
  el("#copyStatus").textContent = ok ? "–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ ‚úî" : "–ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Ctrl/Cmd+C.";
}

/* ==========
   –ì–ï–ù–ï–†–ê–¶–ò–Ø/–°–ë–†–û–°/–ü–ï–ß–ê–¢–¨
   ========== */
function newCase(random=true){
  if(random){
    state.caseIndex = Math.floor(Math.random()*CASES.length);
  }
  // –∞–≤—Ç–æ-–ø—Ä–µ–¥–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ª–æ–≥–∏—á–Ω—ã—Ö —Ñ–ª–∞–≥–æ–≤ –ø–æ–¥ –∫–µ–π—Å? ‚Äî –Ω–µ –æ—Ç–º–µ—á–∞–µ–º; –¥–∞—ë–º —Å—Ç—É–¥–µ–Ω—Ç—É —Ä–µ—à–∏—Ç—å.
  saveState();
  renderCase();
  renderChecklist();
  renderDnD();
  buildReport();
}

function resetAll(){
  if(!confirm("–°–±—Ä–æ—Å–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å?")) return;
  resetState();
  newCase(false);
  // –æ—á–∏—Å—Ç–∫–∞ —á–µ–∫–æ–≤/–∑–æ–Ω
  els("#checklist input[type='checkbox']").forEach(i=> i.checked=false);
  els(".zone").forEach(z=>{ z.innerHTML = z.innerHTML; });
  updateRisk();
  buildReport();
}

function printPage(){ window.print(); }

/* ==========
   START
   ========== */
loadState();
renderCase();
renderChecklist();
renderDnD();
buildReport();
updateRisk();

/* –µ—Å–ª–∏ –Ω–µ—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–æ–≥–æ –∫–µ–π—Å–∞ ‚Äî —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º */
if(typeof state.caseIndex !== "number"){ state.caseIndex = 0; saveState(); }

el("#btnNew").addEventListener("click", ()=>{ state.checks={}; state.dnd={}; saveState(); newCase(true); });
el("#btnReset").addEventListener("click", resetAll);
el("#btnPrint").addEventListener("click", printPage);
el("#btnCopy").addEventListener("click", copyReport);
el("#btnCheckDnD").addEventListener("click", checkDnD);
</script>
</body>
</html>
