<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ ‚Äî –û—à–∏–±–∫–∏ –∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏</title>
<style>
  :root{
    --bg:#ffffff; --ink:#0f172a; --muted:#475569;
    --brand:#1e3a8a; --accent:#0ea5e9; --ok:#059669; --warn:#b45309; --bad:#b91c1c;
    --card:#f8fafc; --line:#e2e8f0; --radius:16px; --shadow:0 10px 30px rgba(2,6,23,.08);
  }
  html,body{background:var(--bg);color:var(--ink);font:16px/1.6 Inter,system-ui,-apple-system,"Segoe UI",Roboto,Arial,sans-serif;margin:0}
  .wrap{max-width:1100px;margin:auto;padding:24px}
  header{border:1px solid var(--line);border-radius:var(--radius);padding:24px;background:linear-gradient(180deg,rgba(30,58,138,.06),transparent);box-shadow:var(--shadow)}
  h1{margin:0 0 .4rem;font-size:1.6rem}
  .eyebrow{font-weight:700;color:var(--brand);text-transform:uppercase;letter-spacing:.06em;font-size:.8rem}
  .subtitle{color:var(--muted);margin:.2rem 0 0}
  .grid{display:grid;gap:18px;margin:22px 0}
  .two{grid-template-columns:repeat(2,minmax(0,1fr))}
  .card{background:var(--card);border:1px solid var(--line);border-radius:var(--radius);padding:18px;box-shadow:var(--shadow)}
  .card h2{font-size:1.15rem;margin:.1rem 0 .6rem}
  .kicker{display:flex;gap:.6ch;align-items:center;color:var(--muted);text-transform:uppercase;letter-spacing:.06em;font-size:.8rem;margin-bottom:.3rem}
  .dot{width:.6rem;height:.6rem;border-radius:99px;background:var(--accent);display:inline-block}
  .note{border-left:4px solid var(--accent);background:linear-gradient(90deg,rgba(14,165,233,.08),transparent);padding:12px;border-radius:10px}
  .btn{appearance:none;border:1px solid var(--line);background:#fff;border-radius:12px;padding:.6rem .9rem;cursor:pointer}
  .btn.brand{background:var(--brand);border-color:var(--brand);color:#fff}
  .btn.ghost{background:#fff}
  .btn:disabled{opacity:.5;cursor:not-allowed}
  .row{display:flex;gap:10px;flex-wrap:wrap}
  .small{font-size:.92rem}
  /* Drag & drop */
  .pool,.bucket{min-height:160px;background:#fff;border:1px dashed var(--line);border-radius:12px;padding:10px;display:grid;grid-template-columns:1fr 1fr;gap:10px}
  .bucket{grid-template-columns:1fr}
  .chip{background:#eef2ff;border:1px solid #c7d2fe;border-radius:999px;padding:.5rem .65rem;font-size:.92rem;cursor:grab;user-select:none;box-shadow:0 2px 0 rgba(30,41,59,.08)}
  .chip.dragging{opacity:.6}
  .bucket h3{margin:.2rem 0 .5rem;font-size:1rem;color:#1e293b}
  .bucket.drop{outline:3px dashed var(--accent)}
  /* Checklist */
  .checklist{display:grid;grid-template-columns:1fr 1fr;gap:8px}
  .item{display:flex;gap:8px;align-items:flex-start;background:#fff;border:1px solid var(--line);border-radius:10px;padding:10px}
  .item label{cursor:pointer}
  .hint{color:var(--muted);font-size:.9rem;margin-top:.3rem}
  .mono{font-family:ui-monospace,Menlo,Consolas,monospace;font-size:.92rem}
  /* Form */
  .field{display:grid;gap:6px;margin:.6rem 0}
  textarea,input[type=text]{width:100%;padding:.7rem;border:1px solid var(--line);border-radius:10px;background:#fff}
  .pill{display:inline-block;border:1px solid var(--line);border-radius:999px;padding:.15rem .5rem;font-size:.8rem;color:var(--muted);background:#fff;margin-right:.35rem}
  /* Score */
  .score{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
  .status{font-weight:800}
  .status.ok{color:var(--ok)} .status.warn{color:var(--warn)} .status.bad{color:var(--bad)}
  progress{width:240px;height:10px}
  /* Footer */
  footer{margin:22px 0 6px;color:var(--muted);font-size:.9rem}
  @media (max-width:960px){.two{grid-template-columns:1fr}.pool{grid-template-columns:1fr}}
</style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="eyebrow">–ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è —Å –±–∞–Ω–∫–æ–º ¬∑ –ü—Ä–∞–∫—Ç–∏–∫–∞</div>
      <h1>–û—à–∏–±–∫–∏ –∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ ‚Äî –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ</h1>
      <p class="subtitle">
        –¶–µ–ª—å: –∑–∞ 12‚Äì15 –º–∏–Ω—É—Ç –æ—Ç—Ä–∞–±–æ—Ç–∞—Ç—å —Ç—Ä–∏ –Ω–∞–≤—ã–∫–∞ ‚Äî <b>—Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫</b>, <b>—Å–±–æ—Ä –ø–æ–ª–Ω–æ–≥–æ –ø–∞–∫–µ—Ç–∞</b> –∏ <b>–Ω–∞–ø–∏—Å–∞–Ω–∏–µ –ø–æ—è—Å–Ω–µ–Ω–∏—è –≤ —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–æ–π –ª–æ–≥–∏–∫–µ</b>.
      </p>
    </header>

    <!-- –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è -->
    <section class="card">
      <div class="kicker"><span class="dot"></span><span>–ö–∞–∫ –≤—ã–ø–æ–ª–Ω–∏—Ç—å</span></div>
      <ol class="small">
        <li>–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –∫–∞—Ä—Ç–æ—á–∫–∏ –≤ ¬´–î–µ–ª–∞–µ–º¬ª –∏ ¬´–ù–µ –¥–µ–ª–∞–µ–º¬ª (–ó–∞–¥–∞–Ω–∏–µ 1).</li>
        <li>–û—Ç–º–µ—Ç—å—Ç–µ, —á—Ç–æ –≤–∫–ª—é—á–∏—Ç–µ –≤ –æ—Ç–≤–µ—Ç –±–∞–Ω–∫—É –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–µ–±—è (–ó–∞–¥–∞–Ω–∏–µ 2).</li>
        <li>–°–æ—Å—Ç–∞–≤—å—Ç–µ –∫–æ—Ä–æ—Ç–∫—É—é –ø–æ—è—Å–Ω–∏—Ç–µ–ª—å–Ω—É—é –∑–∞–ø–∏—Å–∫—É –∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞ (–ó–∞–¥–∞–Ω–∏–µ 3).</li>
      </ol>
      <div class="note small">
        –ü–æ–¥—Å–∫–∞–∑–∫–∞: –¥—É–º–∞–π—Ç–µ –∫–∞–∫ –∫–æ–º–ø–ª–∞–µ–Ω—Å-–æ—Ñ–∏—Ü–µ—Ä ‚Äî –≤–∏–¥–Ω–∞ –ª–∏ <b>—ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∞—è –ª–æ–≥–∏–∫–∞</b>, –µ—Å—Ç—å –ª–∏ <b>—Å–≤—è–∑—å —Å –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é</b>, —Å–æ–±–ª—é–¥–µ–Ω—ã –ª–∏ <b>—Å—Ä–æ–∫–∏</b>?
      </div>
    </section>

    <!-- –ó–∞–¥–∞–Ω–∏–µ 1: drag & drop -->
    <section class="card" id="task1">
      <div class="kicker"><span class="dot"></span><span>–ó–∞–¥–∞–Ω–∏–µ 1</span></div>
      <h2>–†–∞–∑–ª–æ–∂–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏—è: ¬´–î–µ–ª–∞–µ–º¬ª vs ¬´–ù–µ –¥–µ–ª–∞–µ–º¬ª</h2>
      <p class="small">–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –∫–∞—Ä—Ç–æ—á–∫–∏ –∏–∑ ¬´–ü—É–ª¬ª –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –∫–æ—Ä–∑–∏–Ω—ã. –ó–∞—Ç–µ–º –Ω–∞–∂–º–∏—Ç–µ ¬´–ü—Ä–æ–≤–µ—Ä–∏—Ç—å¬ª.</p>

      <div class="grid two">
        <div>
          <h3>–ü—É–ª –¥–µ–π—Å—Ç–≤–∏–π</h3>
          <div class="pool" id="pool" aria-label="–ü—É–ª –¥–µ–π—Å—Ç–≤–∏–π"></div>
        </div>

        <div>
          <div class="bucket" id="do" aria-label="–î–µ–ª–∞–µ–º">
            <h3>‚úÖ –î–µ–ª–∞–µ–º</h3>
          </div>
          <div style="height:12px"></div>
          <div class="bucket" id="dont" aria-label="–ù–µ –¥–µ–ª–∞–µ–º">
            <h3>‚õî –ù–µ –¥–µ–ª–∞–µ–º</h3>
          </div>
        </div>
      </div>

      <div class="row" style="margin-top:12px">
        <button class="btn brand" id="check1">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
        <button class="btn ghost" id="reset1">–°–±—Ä–æ—Å–∏—Ç—å</button>
        <div class="score small" id="score1"></div>
      </div>
    </section>

    <!-- –ó–∞–¥–∞–Ω–∏–µ 2: —á–µ–∫-–ª–∏—Å—Ç –ø–∞–∫–µ—Ç–∞ -->
    <section class="card" id="task2">
      <div class="kicker"><span class="dot"></span><span>–ó–∞–¥–∞–Ω–∏–µ 2</span></div>
      <h2>–°–æ–±–µ—Ä–∏—Ç–µ –ø–æ–ª–Ω—ã–π –ø–∞–∫–µ—Ç –æ—Ç–≤–µ—Ç–∞ –±–∞–Ω–∫—É</h2>
      <p class="small">–û—Ç–º–µ—Ç—å—Ç–µ, —á—Ç–æ –≤—ã –ø—Ä–∏–ª–æ–∂–∏—Ç–µ –∫ –ø–∏—Å—å–º—É. –ù–∞–∂–º–∏—Ç–µ ¬´–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–º–ø–ª–µ–∫—Ç¬ª.</p>

      <div class="checklist" id="checklist">
        <!-- –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —Å–∫—Ä–∏–ø—Ç–æ–º -->
      </div>
      <p class="hint">–§–∞–π–ª—ã –Ω–∞–∑—ã–≤–∞–π—Ç–µ –ø–æ–Ω—è—Ç–Ω–æ, –Ω–∞–ø—Ä–∏–º–µ—Ä: <span class="mono">2025-09-09_Dogovor_15.pdf</span>, <span class="mono">Akt_15_2025-09-30.pdf</span></p>

      <div class="row" style="margin-top:12px">
        <button class="btn brand" id="check2">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–º–ø–ª–µ–∫—Ç</button>
        <button class="btn ghost" id="reset2">–°–±—Ä–æ—Å–∏—Ç—å</button>
        <div class="score small" id="score2"></div>
      </div>
    </section>

    <!-- –ó–∞–¥–∞–Ω–∏–µ 3: –ø–æ—è—Å–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–ø–∏—Å–∫–∞ -->
    <section class="card" id="task3">
      <div class="kicker"><span class="dot"></span><span>–ó–∞–¥–∞–Ω–∏–µ 3</span></div>
      <h2>–ù–∞–ø–∏—à–∏—Ç–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ –≤ —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–æ–π –ª–æ–≥–∏–∫–µ</h2>
      <p class="small">–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–æ–ª—è. –ê–≤—Ç–æ–ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥—Å–≤–µ—Ç–∏—Ç –∫–ª—é—á–µ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã: –ø—Ä–µ–¥–º–µ—Ç, —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π —Å–º—ã—Å–ª, —Å–≤—è–∑—å —Å –û–ö–í–≠–î, –¥–æ–∫—É–º–µ–Ω—Ç—ã –∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞.</p>

      <div class="field">
        <label for="purpose"><b>–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞ (–∫–æ—Ä–æ—Ç–∫–æ, 1‚Äì2 —Å—Ç—Ä–æ–∫–∏)</b></label>
        <input id="purpose" type="text" placeholder="–ù–∞–ø—Ä.: –û–ø–ª–∞—Ç–∞ –∞—Ä–µ–Ω–¥—ã –æ—Ñ–∏—Å–∞ –ø–æ –¥–æ–≥–æ–≤–æ—Ä—É ‚Ññ5 –æ—Ç 01.02.2025" />
      </div>

      <div class="field">
        <label for="memo"><b>–ü–æ—è—Å–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–ø–∏—Å–∫–∞ (5‚Äì7 —Å—Ç—Ä–æ–∫)</b></label>
        <textarea id="memo" rows="7" placeholder="–°—Ç—Ä—É–∫—Ç—É—Ä–∞: 1) –ü—Ä–µ–¥–º–µ—Ç; 2) –≠–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π —Å–º—ã—Å–ª; 3) –°–≤—è–∑—å —Å –û–ö–í–≠–î; 4) –î–æ–∫—É–º–µ–Ω—Ç—ã; 5) –ü–æ—Ç–æ–∫–∏/—Å—Ä–æ–∫–∏"></textarea>
      </div>

      <div class="hint">
        –í—Å—Ç–∞–≤—å—Ç–µ –∫–ª—é—á–µ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã (–ø–æ–¥—Å–≤–µ—á–∏–≤–∞—é—Ç—Å—è –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ):
        <span class="pill">–¥–æ–≥–æ–≤–æ—Ä</span>
        <span class="pill">–∞–∫—Ç / –£–ü–î</span>
        <span class="pill">—Å—á—ë—Ç</span>
        <span class="pill">—ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π —Å–º—ã—Å–ª</span>
        <span class="pill">–û–ö–í–≠–î</span>
        <span class="pill">–≥—Ä–∞—Ñ–∏–∫ –æ–ø–ª–∞—Ç</span>
        <span class="pill">–ø–æ—Å—Ç–∞–≤–∫–∞</span>
        <span class="pill">ROMI / KPI</span>
      </div>

      <div class="row" style="margin-top:12px">
        <button class="btn brand" id="check3">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–µ–∫—Å—Ç</button>
        <button class="btn ghost" id="reset3">–°–±—Ä–æ—Å–∏—Ç—å</button>
        <div class="score small" id="score3"></div>
      </div>
    </section>

    <!-- –ò—Ç–æ–≥ –∏ –æ—Ç—á—ë—Ç -->
    <section class="card" id="result">
      <div class="kicker"><span class="dot"></span><span>–ò—Ç–æ–≥–∏</span></div>
      <h2>–í–∞—à —Ä–µ–∑—É–ª—å—Ç–∞—Ç</h2>
      <div class="score">
        <progress id="progress" value="0" max="100"></progress>
        <span id="overall" class="status">0%</span>
      </div>
      <div class="note" id="report" style="margin-top:10px">
        –í—ã–ø–æ–ª–Ω–∏—Ç–µ –∑–∞–¥–∞–Ω–∏—è –∏ –Ω–∞–∂–º–∏—Ç–µ ¬´–°–æ–±—Ä–∞—Ç—å –æ—Ç—á—ë—Ç¬ª.
      </div>
      <div class="row" style="margin-top:10px">
        <button class="btn brand" id="buildReport">–°–æ–±—Ä–∞—Ç—å –æ—Ç—á—ë—Ç</button>
        <button class="btn ghost" id="copyReport">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –æ—Ç—á—ë—Ç</button>
        <button class="btn ghost" id="resetAll">–ü–æ–ª–Ω—ã–π —Å–±—Ä–æ—Å</button>
      </div>
    </section>

    <footer>–ö—É—Ä—Å ¬´–ö–∞–∫ –≤–µ—Å—Ç–∏ –±–∏–∑–Ω–µ—Å, —á—Ç–æ–±—ã –Ω–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª–∏ —Å—á–µ—Ç–∞ –≤ –±–∞–Ω–∫–µ¬ª ¬∑ –ú–æ–¥—É–ª—å ¬´–ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è —Å –±–∞–Ω–∫–æ–º¬ª ¬∑ –ü–æ–¥—Ç–µ–º–∞ ¬´–û—à–∏–±–∫–∏ –∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏¬ª</footer>
  </div>

<script>
/* ---------- –ó–∞–¥–∞–Ω–∏–µ 1: drag & drop ---------- */
const actions = [
  { id:"a1", text:"–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –ø–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ –≤ –¥–µ–Ω—å –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è", good:true },
  { id:"a2", text:"–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ –¥–æ–≥–æ–≤–æ—Ä –±–µ–∑ –∞–∫—Ç–æ–≤ –∏ –ø–æ—è—Å–Ω–µ–Ω–∏—è", good:false },
  { id:"a3", text:"–î–∞—Ç—å –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π –æ—Ç–≤–µ—Ç —Å –¥–∞—Ç–æ–π —Ñ–∏–Ω–∞–ª—å–Ω–æ–π –≤—ã–≥—Ä—É–∑–∫–∏", good:true },
  { id:"a4", text:"–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –∏ —É–ø—Ä—ë–∫–∏", good:false },
  { id:"a5", text:"–û–±–æ–∑–Ω–∞—á–∏—Ç—å –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–µ–π –≤ —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–æ–π –ª–æ–≥–∏–∫–µ", good:true },
  { id:"a6", text:"–ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å –¥–æ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –¥–Ω—è", good:false },
  { id:"a7", text:"–ü—Ä–µ–¥—É–ø—Ä–µ–¥–∏—Ç—å –±–∞–Ω–∫ –æ –∫—Ä—É–ø–Ω–æ–º —Å–Ω—è—Ç–∏–∏ –∏ –ø—Ä–∏–ª–æ–∂–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç—ã", good:true },
  { id:"a8", text:"–†–∞—Å–ø—Ä–µ–¥–µ–ª—è—Ç—å –æ—Ç–≤–µ—Ç—ã –º–µ–∂–¥—É —Ä–∞–∑–Ω—ã–º–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º–∏ –±–µ–∑ –∫–æ–Ω—Ç—Ä–æ–ª—è", good:false }
];

const pool = document.querySelector('#pool');
const doBucket = document.querySelector('#do');
const dontBucket = document.querySelector('#dont');
const score1 = document.querySelector('#score1');
const check1 = document.querySelector('#check1');
const reset1 = document.querySelector('#reset1');

function renderPool(){
  pool.innerHTML = '';
  actions.forEach(a=>{
    const chip = document.createElement('div');
    chip.className = 'chip';
    chip.textContent = a.text;
    chip.draggable = true;
    chip.dataset.id = a.id;
    chip.addEventListener('dragstart', e=>{ chip.classList.add('dragging'); e.dataTransfer.setData('text/plain', a.id); });
    chip.addEventListener('dragend', ()=>chip.classList.remove('dragging'));
    pool.appendChild(chip);
  });
}
['dragover','drop','dragenter','dragleave'].forEach(evt=>{
  [doBucket,dontBucket,pool].forEach(box=>{
    box.addEventListener('dragover', e=>{ e.preventDefault(); box.classList.add('drop'); });
    box.addEventListener('dragleave', ()=> box.classList.remove('drop'));
    box.addEventListener('drop', e=>{
      e.preventDefault();
      const id = e.dataTransfer.getData('text/plain');
      const chip = document.querySelector(`.chip[data-id="${id}"]`);
      if(chip){ box.appendChild(chip); }
      box.classList.remove('drop');
      saveState();
    });
  });
});

function checkTask1(){
  const goodInDo = [...doBucket.querySelectorAll('.chip')].filter(ch=> {
    const a = actions.find(x=>x.id===ch.dataset.id);
    return a && a.good;
  }).length;
  const badInDont = [...dontBucket.querySelectorAll('.chip')].filter(ch=>{
    const a = actions.find(x=>x.id===ch.dataset.id);
    return a && !a.good;
  }).length;
  const totalGood = actions.filter(a=>a.good).length;
  const totalBad  = actions.filter(a=>!a.good).length;
  const score = Math.round( ( (goodInDo/totalGood) + (badInDont/totalBad) ) / 2 * 100 );
  score1.innerHTML = `–†–µ–∑—É–ª—å—Ç–∞—Ç: <b>${score}%</b> ‚Äî ${feedback(score)}`;
  localStorage.setItem('t1', score);
  updateOverall();
}
function resetTask1(){
  renderPool(); doBucket.querySelectorAll('.chip').forEach(n=>n.remove());
  dontBucket.querySelectorAll('.chip').forEach(n=>n.remove());
  score1.textContent = '';
  localStorage.removeItem('t1'); saveState(); updateOverall();
}
check1.addEventListener('click', checkTask1);
reset1.addEventListener('click', resetTask1);

/* ---------- –ó–∞–¥–∞–Ω–∏–µ 2: —á–µ–∫-–ª–∏—Å—Ç ---------- */
const checklistSpec = [
  {id:'c1', txt:'–î–æ–≥–æ–≤–æ—Ä/—Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è', must:true},
  {id:'c2', txt:'–°—á—ë—Ç/—Å—á—ë—Ç-—Ñ–∞–∫—Ç—É—Ä–∞', must:true},
  {id:'c3', txt:'–ê–∫—Ç/–£–ü–î/–Ω–∞–∫–ª–∞–¥–Ω–∞—è', must:true},
  {id:'c4', txt:'–ü–æ—è—Å–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–ø–∏—Å–∫–∞ (—ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∞—è –ª–æ–≥–∏–∫–∞)', must:true},
  {id:'c5', txt:'–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–æ—Å—Ç–∞–≤–∫–∏/–æ–∫–∞–∑–∞–Ω–∏—è', must:true},
  {id:'c6', txt:'–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ–ø–ª–∞—Ç—ã (–≤—ã–ø–∏—Å–∫–∞/–ø–ª–∞—Ç—ë–∂–∫–∞)', must:true},
  {id:'c7', txt:'–ú–µ–¥–∏–∞–ø–ª–∞–Ω/–æ—Ç—á—ë—Ç –ø–æ KPI (–µ—Å–ª–∏ —ç—Ç–æ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥)', must:false},
  {id:'c8', txt:'–ü–∏—Å—å–º–æ-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏ (–ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏)', must:false},
  {id:'c9', txt:'–°–∫—Ä–∏–Ω —ç–º–æ—Ü–∏–π –∏–∑ –ø–µ—Ä–µ–ø–∏—Å–∫–∏ üòâ', must:false},        // –∑–∞–≤–µ–¥–æ–º–æ –ª–∏—à–Ω–µ–µ
  {id:'c10', txt:'–£—á—ë—Ç–Ω–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞/–û–ö–í–≠–î (–ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ)', must:false},
];

const checklistDiv = document.querySelector('#checklist');
const score2 = document.querySelector('#score2');
document.querySelector('#check2').addEventListener('click', ()=>{
  const chosen = [...checklistDiv.querySelectorAll('input[type=checkbox]')].filter(c=>c.checked).map(c=>c.id);
  const must = checklistSpec.filter(x=>x.must).map(x=>x.id);
  const hasAllMust = must.every(id=>chosen.includes(id));
  const hasBad = chosen.includes('c9'); // –∑–∞–≤–µ–¥–æ–º–æ –ª–∏—à–Ω–µ–µ
  let score = 0;
  if(hasAllMust && !hasBad){
    const opt = checklistSpec.filter(x=>!x.must && x.id!=='c9').map(x=>x.id);
    const optChosen = opt.filter(id=>chosen.includes(id)).length;
    score = Math.min(100, 70 + optChosen*10);
  }else{
    const mustCount = must.filter(id=>chosen.includes(id)).length;
    score = Math.round( (mustCount / must.length) * 70 ) - (hasBad?20:0);
    score = Math.max(0, score);
  }
  score2.innerHTML = `–ö–æ–º–ø–ª–µ–∫—Ç: <b>${score}%</b> ‚Äî ${feedback(score)}`;
  localStorage.setItem('t2', score);
  updateOverall();
});
document.querySelector('#reset2').addEventListener('click', ()=>{
  checklistDiv.querySelectorAll('input[type=checkbox]').forEach(c=>c.checked=false);
  score2.textContent=''; localStorage.removeItem('t2'); updateOverall(); saveState();
});

function renderChecklist(){
  checklistDiv.innerHTML='';
  checklistSpec.forEach(x=>{
    const el = document.createElement('div'); el.className='item';
    el.innerHTML = `
      <input id="${x.id}" type="checkbox" />
      <label for="${x.id}">
        ${x.txt} ${x.must?'<span class="pill">–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ</span>':''}
      </label>`;
    checklistDiv.appendChild(el);
  });
  // restore
  const saved = JSON.parse(localStorage.getItem('checklist')||'[]');
  saved.forEach(id=>{
    const c = document.getElementById(id);
    if(c) c.checked = true;
  });
  checklistDiv.addEventListener('change', ()=>{
    const chosen = [...checklistDiv.querySelectorAll('input[type=checkbox]')].filter(c=>c.checked).map(c=>c.id);
    localStorage.setItem('checklist', JSON.stringify(chosen));
  });
}

/* ---------- –ó–∞–¥–∞–Ω–∏–µ 3: —Ç–µ–∫—Å—Ç –∏ –∞–≤—Ç–æ–ø—Ä–æ–≤–µ—Ä–∫–∞ ---------- */
const keyPhrases = [
  /–¥–æ–≥–æ–≤–æ—Ä/i, /(–∞–∫—Ç|—É–ø–¥|–Ω–∞–∫–ª–∞–¥–Ω)/i, /—Å—á[–µ—ë]—Ç/i, /—ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫.*—Å–º—ã—Å–ª/i, /–æ–∫–≤—ç–¥/i,
  /(–≥—Ä–∞—Ñ–∏–∫|—Å—Ä–æ–∫).*–æ–ø–ª–∞—Ç/i, /(–ø–æ—Å—Ç–∞–≤–∫|–æ–∫–∞–∑–∞–Ω)/i, /kpi|romi/i, /(–Ω–∞–∑–Ω–∞—á–µ–Ω–∏|–æ–ø–ª–∞—Ç–∞).*(–ø–æ –¥–æ–≥–æ–≤–æ—Ä—É|–∑–∞)/i
];
const score3Box = document.querySelector('#score3');
document.querySelector('#check3').addEventListener('click', ()=>{
  const purpose = document.querySelector('#purpose').value.trim();
  const memo = document.querySelector('#memo').value.trim();
  let text = (purpose + " " + memo).toLowerCase();
  let hits = 0;
  keyPhrases.forEach(rx=>{ if(rx.test(text)) hits++; });
  // –±–∞–∑–æ–≤—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è: –¥–ª–∏–Ω–∞ purpose > 25, memo > 200 —Å–∏–º–≤–æ–ª–æ–≤
  const lenBonus = (purpose.length>25 ? 1 : 0) + (memo.length>200 ? 1 : 0);
  const score = Math.min(100, Math.round((hits/ keyPhrases.length)*90) + lenBonus*5);
  score3Box.innerHTML = `–ö–∞—á–µ—Å—Ç–≤–æ –ø–æ—è—Å–Ω–µ–Ω–∏—è: <b>${score}%</b> ‚Äî ${feedback(score)}`
    + highlightFound(memo);
  localStorage.setItem('t3', score);
  localStorage.setItem('purpose', purpose);
  localStorage.setItem('memo', memo);
  updateOverall();
});
document.querySelector('#reset3').addEventListener('click', ()=>{
  document.querySelector('#purpose').value='';
  document.querySelector('#memo').value='';
  score3Box.textContent=''; ['t3','purpose','memo'].forEach(k=>localStorage.removeItem(k));
  updateOverall();
});

/* ---------- –ò—Ç–æ–≥–∏ –∏ –æ—Ç—á—ë—Ç ---------- */
const progressEl = document.querySelector('#progress');
const overallEl = document.querySelector('#overall');
function updateOverall(){
  const s1 = Number(localStorage.getItem('t1')||0);
  const s2 = Number(localStorage.getItem('t2')||0);
  const s3 = Number(localStorage.getItem('t3')||0);
  const scores = [s1,s2,s3];
  const filled = scores.filter(s=>s>0);
  const avg = filled.length ? Math.round(filled.reduce((a,b)=>a+b,0)/filled.length) : 0;
  progressEl.value = avg; overallEl.textContent = `${avg}%`;
  overallEl.className = 'status ' + (avg>=85?'ok':avg>=60?'warn':'bad');
}
document.querySelector('#buildReport').addEventListener('click', ()=>{
  const s1 = Number(localStorage.getItem('t1')||0);
  const s2 = Number(localStorage.getItem('t2')||0);
  const s3 = Number(localStorage.getItem('t3')||0);
  const chosen = JSON.parse(localStorage.getItem('checklist')||'[]').map(id=>{
    const spec = checklistSpec.find(x=>x.id===id); return spec?spec.txt:id;
  });
  const report = [
    '–û—Ç—á—ë—Ç –ø–æ –ø—Ä–∞–∫—Ç–∏–∫–µ ‚Äî –ö–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è —Å –±–∞–Ω–∫–æ–º',
    '--------------------------------------------------',
    `–ó–∞–¥–∞–Ω–∏–µ 1 (—Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π): ${s1||0}%`,
    `–ó–∞–¥–∞–Ω–∏–µ 2 (–∫–æ–º–ø–ª–µ–∫—Ç –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤): ${s2||0}%`,
    `–ó–∞–¥–∞–Ω–∏–µ 3 (–ø–æ—è—Å–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–ø–∏—Å–∫–∞): ${s3||0}%`,
    `–û–±—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: ${overallEl.textContent}`,
    '',
    '–í—ã–±—Ä–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã:',
    chosen.length?('‚Ä¢ ' + chosen.join('\n‚Ä¢ ')):'‚Äî',
    '',
    '–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞:',
    localStorage.getItem('purpose')||'‚Äî',
    '',
    '–ß–µ—Ä–Ω–æ–≤–∏–∫ –ø–æ—è—Å–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∑–∞–ø–∏—Å–∫–∏:',
    (localStorage.getItem('memo')||'‚Äî').slice(0,4000),
    '',
    '–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:',
    recs(Math.max(s1,s2,s3), Math.min(s1,s2,s3))
  ].join('\n');
  document.querySelector('#report').textContent = report;
});
document.querySelector('#copyReport').addEventListener('click', async()=>{
  const txt = document.querySelector('#report').textContent;
  try{ await navigator.clipboard.writeText(txt); toast('–û—Ç—á—ë—Ç —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞'); }
  catch(e){ toast('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å. –í—ã–¥–µ–ª–∏—Ç–µ —Ç–µ–∫—Å—Ç –∏ –Ω–∞–∂–º–∏—Ç–µ Ctrl+C'); }
});
document.querySelector('#resetAll').addEventListener('click', ()=>{
  localStorage.clear(); location.reload();
});

/* ---------- helpers ---------- */
function feedback(score){
  if(score>=90) return '–æ—Ç–ª–∏—á–Ω–æ: –ª–æ–≥–∏–∫–∞ –ø—Ä–æ–∑—Ä–∞—á–Ω–∞, —Ä–∏—Å–∫ –Ω–∏–∑–∫–∏–π';
  if(score>=75) return '—Ö–æ—Ä–æ—à–æ: –µ—Å—Ç—å –º–µ–ª–∫–∏–µ –Ω–µ–¥–æ—á—ë—Ç—ã';
  if(score>=60) return '—É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ: –¥–æ—Ä–∞–±–æ—Ç–∞–π—Ç–µ –∫–æ–º–ø–ª–µ–∫—Ç –∏ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏';
  return '–Ω—É–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å: –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç –ª–æ–≥–∏–∫–∏/–¥–æ–∫—É–º–µ–Ω—Ç–æ–≤';
}
function highlightFound(text){
  const found = keyPhrases.filter(rx=>rx.test((text||'').toLowerCase())).length;
  return `<div class="hint">–ö–ª—é—á–µ–≤—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤: <b>${found}/${keyPhrases.length}</b></div>`;
}
function recs(maxS, minS){
  const list = [];
  if(minS<70) list.push('‚Äî –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã: –¥–æ–≥–æ–≤–æ—Ä, —Å—á—ë—Ç, –∞–∫—Ç/–£–ü–î, –ø–æ—è—Å–Ω–µ–Ω–∏–µ, –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–æ—Å—Ç–∞–≤–∫–∏ –∏ –æ–ø–ª–∞—Ç—ã.');
  if(maxS<90) list.push('‚Äî –£—Ç–æ—á–Ω–∏—Ç–µ —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π —Å–º—ã—Å–ª –∏ —Å–≤—è–∑—å —Å –û–ö–í–≠–î; –¥–æ–±–∞–≤—å—Ç–µ –≥—Ä–∞—Ñ–∏–∫ –æ–ø–ª–∞—Ç –∏ KPI/ROMI (–¥–ª—è –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–∞).');
  list.push('‚Äî –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–π—Ç–µ –ø–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ –≤ –¥–µ–Ω—å –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è –∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π –¥–µ–ª–æ–≤–æ–π —Ç–æ–Ω.');
  return list.join('\n');
}
function toast(msg){
  const t = document.createElement('div');
  t.textContent = msg;
  Object.assign(t.style,{
    position:'fixed',bottom:'20px',left:'50%',transform:'translateX(-50%)',
    background:'#111',color:'#fff',padding:'10px 14px',borderRadius:'10px',opacity:'0.95',zIndex:9999
  });
  document.body.appendChild(t); setTimeout(()=>t.remove(), 2200);
}

function saveState(){
  // save pools
  const idsPool = [...pool.querySelectorAll('.chip')].map(x=>x.dataset.id);
  const idsDo   = [...doBucket.querySelectorAll('.chip')].map(x=>x.dataset.id);
  const idsDont = [...dontBucket.querySelectorAll('.chip')].map(x=>x.dataset.id);
  localStorage.setItem('pool', JSON.stringify(idsPool));
  localStorage.setItem('do', JSON.stringify(idsDo));
  localStorage.setItem('dont', JSON.stringify(idsDont));
}
function restoreState(){
  const p = JSON.parse(localStorage.getItem('pool')||'[]');
  const d = JSON.parse(localStorage.getItem('do')||'[]');
  const n = JSON.parse(localStorage.getItem('dont')||'[]');
  const makeChip = id=>{
    const a = actions.find(x=>x.id===id); if(!a) return null;
    const chip = document.createElement('div');
    chip.className='chip'; chip.textContent=a.text; chip.draggable=true; chip.dataset.id=a.id;
    chip.addEventListener('dragstart', e=>{ chip.classList.add('dragging'); e.dataTransfer.setData('text/plain', a.id); });
    chip.addEventListener('dragend', ()=>chip.classList.remove('dragging'));
    return chip;
  };
  if(p.length || d.length || n.length){
    pool.innerHTML=''; [p,d,n].forEach((arr,i)=>{
      arr.forEach(id=>{
        const chip = makeChip(id);
        if(!chip) return;
        (i===0?pool: i===1?doBucket:dontBucket).appendChild(chip);
      });
    });
  }
}

(function init(){
  renderPool();
  renderChecklist();
  restoreState();
  // restore text
  const purpose = localStorage.getItem('purpose'); if(purpose) document.querySelector('#purpose').value = purpose;
  const memo = localStorage.getItem('memo'); if(memo) document.querySelector('#memo').value = memo;
  updateOverall();
})();
</script>
</body>
</html>
